
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Phydrax scientific ML and PDE toolkit.">
      
      
        <meta name="author" content="Phydra Labs">
      
      
        <link rel="canonical" href="https://phydra-labs.github.io/phydrax/appendix/differentiation_modes/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../physics_constrained_interpolation/">
      
      
      <link rel="icon" href="../../_static/phydra.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Differentiation modes - Phydrax</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../_static/custom_css.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#differentiation-modes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Phydrax" class="md-header__button md-logo" aria-label="Phydrax" data-md-component="logo">
      
  <img src="../../_static/phydra.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phydrax
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Differentiation modes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/phydra-labs/phydrax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    phydra-labs/phydrax
  </div>
</a>

  <a href="https://x.com/PhydraLabs" title="@PhydraLabs" class="md-source md-source--x" aria-label="@PhydraLabs" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"/>
</svg>
    </div>
    
      <div class="md-source__repository md-source__repository--x">
        @PhydraLabs
      </div>
    
  </a>


  <a href="https://www.linkedin.com/company/phydra-labs" title="LinkedIn" class="md-source md-source--linkedin" aria-label="LinkedIn" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg viewBox="10 10 52 52" xmlns="http://www.w3.org/2000/svg">
  <path d="M62 62H51.315625V43.8021149C51.315625 38.8127542 49.4197917 36.0245323 45.4707031 36.0245323C41.1746094 36.0245323 38.9300781 38.9261103 38.9300781 43.8021149V62H28.6333333V27.3333333H38.9300781V32.0029283C38.9300781 32.0029283 42.0260417 26.2742151 49.3825521 26.2742151C56.7356771 26.2742151 62 30.7644705 62 40.051212V62ZM16.349349 22.7940133C12.8420573 22.7940133 10 19.9296567 10 16.3970067C10 12.8643566 12.8420573 10 16.349349 10C19.8566406 10 22.6970052 12.8643566 22.6970052 16.3970067C22.6970052 19.9296567 19.8566406 22.7940133 16.349349 22.7940133ZM11.0325521 62H21.769401V27.3333333H11.0325521V62Z" fill="currentColor"/>
</svg>
    </div>
  </a>

      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Phydrax" class="md-nav__button md-logo" aria-label="Phydrax" data-md-component="logo">
      
  <img src="../../_static/phydra.png" alt="logo">

    </a>
    Phydrax
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/phydra-labs/phydrax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    phydra-labs/phydrax
  </div>
</a>

  <a href="https://x.com/PhydraLabs" title="@PhydraLabs" class="md-source md-source--x" aria-label="@PhydraLabs" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"/>
</svg>
    </div>
    
      <div class="md-source__repository md-source__repository--x">
        @PhydraLabs
      </div>
    
  </a>


  <a href="https://www.linkedin.com/company/phydra-labs" title="LinkedIn" class="md-source md-source--linkedin" aria-label="LinkedIn" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg viewBox="10 10 52 52" xmlns="http://www.w3.org/2000/svg">
  <path d="M62 62H51.315625V43.8021149C51.315625 38.8127542 49.4197917 36.0245323 45.4707031 36.0245323C41.1746094 36.0245323 38.9300781 38.9261103 38.9300781 43.8021149V62H28.6333333V27.3333333H38.9300781V32.0029283C38.9300781 32.0029283 42.0260417 26.2742151 49.3825521 26.2742151C56.7356771 26.2742151 62 30.7644705 62 40.051212V62ZM16.349349 22.7940133C12.8420573 22.7940133 10 19.9296567 10 16.3970067C10 12.8643566 12.8420573 10 16.349349 10C19.8566406 10 22.6970052 12.8643566 22.6970052 16.3970067C22.6970052 19.9296567 19.8566406 22.7940133 16.349349 22.7940133ZM11.0325521 62H21.769401V27.3333333H11.0325521V62Z" fill="currentColor"/>
</svg>
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../all-of-phydrax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All of Phydrax
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cookbook
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cookbook
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/poisson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Poisson (field learning)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/heat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heat equation (space–time)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/inverse_and_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inverse + hybrid physics–data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/operator_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operator learning (DatasetDomain)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domains and sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_differential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_integrals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrals and measures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constraints and objectives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solvers and training
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/phydrax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Domains
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Domains
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/geometry1d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (1D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/geometry2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (2D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/geometry3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (3D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/composition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Composition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/differential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/integral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/linalg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear algebra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/delay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delay
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Constraints
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/continuous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continuous
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/boundary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boundary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/discrete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discrete
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/enforced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforced constraint ansätze
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/cfd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CFD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/solid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/thermal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thermal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/em/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electromagnetics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Neural networks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Neural networks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/architectures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architectures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/structured/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structured
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/wrappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wrappers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/embeddings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/activations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solver
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solver/functional_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional solver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solver/enforced_constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforced constraint pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/nondimensionalization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nondimensionalization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Differentiation modes
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Differentiation modes
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0-summary-of-user-facing-knobs" class="md-nav__link">
    <span class="md-ellipsis">
      0. Summary of user-facing knobs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-notation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Notation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-backendad-automatic-differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      2. backend="ad": automatic differentiation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. backend=&#34;ad&#34;: automatic differentiation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-forward-vs-reverse-mode-ad-modeforward-reverse" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Forward- vs reverse-mode AD (mode="forward" / "reverse")
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-higher-derivatives-via-nested-transforms" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Higher derivatives via nested transforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-complex-valued-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Complex-valued outputs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-backendjet-taylor-mode-ad-derivative-jets" class="md-nav__link">
    <span class="md-ellipsis">
      3. backend="jet": Taylor-mode AD (derivative jets)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. backend=&#34;jet&#34;: Taylor-mode AD (derivative jets)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-pure-partial-derivatives-as-directional-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Pure partial derivatives as directional derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-what-jets-do-and-do-not-give-you-cheaply" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 What jets do (and do not) give you cheaply
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-backendfd-finite-differences-on-coord-separable-grids" class="md-nav__link">
    <span class="md-ellipsis">
      4. backend="fd": finite differences on coord-separable grids
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. backend=&#34;fd&#34;: finite differences on coord-separable grids">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-first-derivative-uniform-grid" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 First derivative (uniform grid)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-higher-derivatives-and-multi-d-tensor-grids" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Higher derivatives and multi-D tensor grids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-backendbasis-basis-aware-derivatives-on-structured-grids" class="md-nav__link">
    <span class="md-ellipsis">
      5. backend="basis": basis-aware derivatives on structured grids
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. backend=&#34;basis&#34;: basis-aware derivatives on structured grids">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-fourier-spectral-derivatives-basisfourier" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Fourier spectral derivatives (basis="fourier")
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-sinecosine-bases-basissine-cosine" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Sine/cosine bases (basis="sine" / "cosine")
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-polynomial-barycentric-differentiation-basispoly" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 Polynomial / barycentric differentiation (basis="poly")
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-practical-guidance-what-to-use-when" class="md-nav__link">
    <span class="md-ellipsis">
      6. Practical guidance (what to use when)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../physics_constrained_interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Physics-Constrained Interpolation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../surely_youre_joking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Surely You're Joking!
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="differentiation-modes">Differentiation modes<a class="headerlink" href="#differentiation-modes" title="Permanent link">¤</a></h1>
<p>This appendix gives a deeper mathematical explanation of the <strong>differentiation modes</strong> available in Phydrax’s
differential operators. Here “differentiation” refers to derivatives with respect to <strong>labeled domain variables</strong>
(e.g. space <code>"x"</code> or time <code>"t"</code>), as used by operators like <code>grad</code>, <code>partial_n</code>, <code>laplacian</code>, etc.</p>
<p>For the definitions and tensor shape conventions of the operators themselves, see
<a href="../../guides_differential/">Guides → Differential operators</a>.</p>
<h2 id="0-summary-of-user-facing-knobs">0. Summary of user-facing knobs<a class="headerlink" href="#0-summary-of-user-facing-knobs" title="Permanent link">¤</a></h2>
<p>Many differential operators share two primary keywords:</p>
<ul>
<li><code>backend</code>: selects <em>how</em> the derivative is computed:</li>
<li><code>"ad"</code>: automatic differentiation,</li>
<li><code>"jet"</code>: Taylor-mode AD (derivative jets) for higher-order pure derivatives,</li>
<li><code>"fd"</code>: finite differences on coord-separable grids (with AD fallback),</li>
<li><code>"basis"</code>: basis-aware (spectral / interpolation) derivatives on coord-separable grids (with AD fallback).</li>
<li><code>mode</code>: selects the autodiff <em>direction</em> when <code>backend="ad"</code>:</li>
<li><code>"reverse"</code>: reverse-mode (<code>jax.jacrev</code>),</li>
<li><code>"forward"</code>: forward-mode (<code>jax.jacfwd</code>).</li>
</ul>
<p>Some operators additionally accept:</p>
<ul>
<li><code>basis ∈ {"poly","fourier","sine","cosine"}</code> when <code>backend="basis"</code>;</li>
<li><code>periodic ∈ {False,True}</code> when <code>backend="fd"</code>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>backend="fd"</code> and <code>backend="basis"</code> require <strong>coord-separable</strong> (structured-grid) evaluation for the variable being
differentiated.</p>
</div>
<h2 id="1-notation">1. Notation<a class="headerlink" href="#1-notation" title="Permanent link">¤</a></h2>
<p>Fix a labeled product domain <span class="arithmatex">\(\Omega=\Omega_x\times\Omega_t\times\cdots\)</span>. For a geometry label <span class="arithmatex">\(x\in\mathbb{R}^d\)</span>,
write <span class="arithmatex">\(x=(x_1,\dots,x_d)\)</span>. For a scalar label <span class="arithmatex">\(t\in\mathbb{R}\)</span>, write <span class="arithmatex">\(t\)</span>.</p>
<p>Locally, a <code>DomainFunction</code> can be viewed as a map</p>
<div class="arithmatex">\[
u:\Omega\to \mathbb{R}^m,
\]</div>
<p>where <span class="arithmatex">\(m\)</span> may itself represent a multi-axis tensor value; derivatives are taken componentwise with respect to the
domain variable(s).</p>
<p>For a smooth map <span class="arithmatex">\(f:\mathbb{R}^d\to\mathbb{R}^m\)</span>, let <span class="arithmatex">\(J_f(x)\in\mathbb{R}^{m\times d}\)</span> denote the Jacobian, and
for a direction <span class="arithmatex">\(v\in\mathbb{R}^d\)</span> define the <span class="arithmatex">\(k\)</span>-th <strong>directional derivative</strong> along <span class="arithmatex">\(v\)</span> by</p>
<div class="arithmatex">\[
\partial_v^k f(x) \;:=\; \left.\frac{d^k}{d\epsilon^k} f(x+\epsilon v)\right|_{\epsilon=0}.
\]</div>
<p>For <span class="arithmatex">\(k=1\)</span>, <span class="arithmatex">\(\partial_v f(x)=J_f(x)\,v\)</span>. For <span class="arithmatex">\(v=e_i\)</span> (a coordinate axis), <span class="arithmatex">\(\partial_{e_i}^k f\)</span> reduces to the
pure partial derivative <span class="arithmatex">\(\partial^k f/\partial x_i^k\)</span> (componentwise).</p>
<h2 id="2-backendad-automatic-differentiation">2. <code>backend="ad"</code>: automatic differentiation<a class="headerlink" href="#2-backendad-automatic-differentiation" title="Permanent link">¤</a></h2>
<p>The AD backend computes derivatives by applying the chain rule through the program that evaluates <span class="arithmatex">\(u\)</span>. It is the
default and works for both point sampling and coord-separable sampling.</p>
<h3 id="21-forward-vs-reverse-mode-ad-modeforward-reverse">2.1 Forward- vs reverse-mode AD (<code>mode="forward"</code> / <code>"reverse"</code>)<a class="headerlink" href="#21-forward-vs-reverse-mode-ad-modeforward-reverse" title="Permanent link">¤</a></h3>
<p>The core linear maps behind AD are:</p>
<p><strong>JVP</strong> (Jacobian–vector product). For a tangent direction <span class="arithmatex">\(v\)</span>,</p>
<div class="arithmatex">\[
\mathrm{JVP}_f(x; v) = J_f(x)\,v.
\]</div>
<p><strong>VJP</strong> (vector–Jacobian product). For a cotangent <span class="arithmatex">\(w\)</span>,</p>
<div class="arithmatex">\[
\mathrm{VJP}_f(x; w) = w^\top J_f(x)\quad(\text{equivalently }J_f(x)^\top w).
\]</div>
<p>Forward-mode AD is efficient when you need many JVPs (few input dimensions), while reverse-mode AD is efficient when
you need many VJPs (few output dimensions). When constructing full Jacobians, Phydrax exposes this choice as:</p>
<ul>
<li><code>mode="forward"</code>: <code>jax.jacfwd</code> (conceptually “columns” via JVPs),</li>
<li><code>mode="reverse"</code>: <code>jax.jacrev</code> (conceptually “rows” via VJPs).</li>
</ul>
<p>Rule of thumb for pointwise Jacobians <span class="arithmatex">\(J_f\in\mathbb{R}^{m\times d}\)</span>:</p>
<ul>
<li>prefer <strong>reverse-mode</strong> when <span class="arithmatex">\(m\ll d\)</span> (e.g. scalar outputs),</li>
<li>prefer <strong>forward-mode</strong> when <span class="arithmatex">\(d\ll m\)</span>.</li>
</ul>
<h3 id="22-higher-derivatives-via-nested-transforms">2.2 Higher derivatives via nested transforms<a class="headerlink" href="#22-higher-derivatives-via-nested-transforms" title="Permanent link">¤</a></h3>
<p>Second derivatives can be formed by nesting Jacobian transforms. For example, for scalar-valued <span class="arithmatex">\(u\)</span> and geometry
variable <span class="arithmatex">\(x\in\mathbb{R}^d\)</span>,</p>
<div class="arithmatex">\[
\nabla^2 u(x) \;=\; \nabla_x(\nabla_x u(x)),
\]</div>
<p>and the Laplacian is the trace</p>
<div class="arithmatex">\[
\Delta u(x)\;=\;\mathrm{tr}\bigl(\nabla^2 u(x)\bigr)=\sum_{i=1}^d \frac{\partial^2 u}{\partial x_i^2}(x).
\]</div>
<p>Nesting AD is exact up to floating-point and provides mixed partials <span class="arithmatex">\(\partial_{x_i x_j}u\)</span> as well, but it can
become expensive when building large Hessians or higher-order derivatives.</p>
<h3 id="23-complex-valued-outputs">2.3 Complex-valued outputs<a class="headerlink" href="#23-complex-valued-outputs" title="Permanent link">¤</a></h3>
<p>For complex-valued outputs, Phydrax treats differentiation as real differentiation of the pair
<span class="arithmatex">\((\operatorname{Re}u,\operatorname{Im}u)\)</span>, i.e. it computes Jacobians for real and imaginary parts separately and
recombines them. This avoids relying on holomorphic assumptions and matches the “differentiate <span class="arithmatex">\(\mathbb{R}^2\)</span>”
interpretation of complex numbers.</p>
<h2 id="3-backendjet-taylor-mode-ad-derivative-jets">3. <code>backend="jet"</code>: Taylor-mode AD (derivative jets)<a class="headerlink" href="#3-backendjet-taylor-mode-ad-derivative-jets" title="Permanent link">¤</a></h2>
<p>The jet backend computes <strong>higher-order directional derivatives</strong> by propagating a truncated Taylor series through
the computation.</p>
<p>Fix a smooth map <span class="arithmatex">\(f\)</span> and a direction <span class="arithmatex">\(v\)</span>. Consider the 1D curve <span class="arithmatex">\(y(\epsilon)=f(x+\epsilon v)\)</span>. Its Taylor
expansion is</p>
<div class="arithmatex">\[
f(x+\epsilon v)
= f(x) + \sum_{k=1}^{K}\frac{\epsilon^k}{k!}\,\partial_v^k f(x) + O(\epsilon^{K+1}).
\]</div>
<p>The jet backend returns the coefficients (directional derivatives)
<span class="arithmatex">\(\bigl(\partial_v^k f(x)\bigr)_{k=1}^K\)</span> directly, using JAX’s jet machinery (whose internal chain rules are
governed by Faà di Bruno / Bell polynomial combinatorics).</p>
<h3 id="31-pure-partial-derivatives-as-directional-derivatives">3.1 Pure partial derivatives as directional derivatives<a class="headerlink" href="#31-pure-partial-derivatives-as-directional-derivatives" title="Permanent link">¤</a></h3>
<p>Pure <span class="arithmatex">\(n\)</span>-th partial derivatives along a coordinate axis are directional derivatives with <span class="arithmatex">\(v=e_i\)</span>. For a geometry
variable <span class="arithmatex">\(x\in\mathbb{R}^d\)</span>,</p>
<div class="arithmatex">\[
\frac{\partial^n f}{\partial x_i^n}(x) \;=\; \partial_{e_i}^n f(x).
\]</div>
<p>Similarly, for a scalar variable <span class="arithmatex">\(t\)</span>,</p>
<div class="arithmatex">\[
\frac{d^n}{dt^n} f(t)\;=\;\left.\frac{d^n}{d\epsilon^n} f(t+\epsilon)\right|_{\epsilon=0}.
\]</div>
<p>This is exactly the situation targeted by <code>partial_n(..., backend="jet")</code>, which is why jets are a natural fit for
high-order derivatives with respect to a <strong>single</strong> labeled variable and a <strong>single</strong> axis.</p>
<h3 id="32-what-jets-do-and-do-not-give-you-cheaply">3.2 What jets do (and do not) give you cheaply<a class="headerlink" href="#32-what-jets-do-and-do-not-give-you-cheaply" title="Permanent link">¤</a></h3>
<p>Jets provide efficient access to <em>pure</em> derivatives like <span class="arithmatex">\(\partial_{x_i}^n u\)</span>. Mixed partials like
<span class="arithmatex">\(\partial_{x_i}\partial_{x_j}u\)</span> with <span class="arithmatex">\(i\neq j\)</span> are not directly obtained from a single 1D directional expansion;
they require genuinely multi-directional information (and are typically constructed via nested AD / Hessians).</p>
<h2 id="4-backendfd-finite-differences-on-coord-separable-grids">4. <code>backend="fd"</code>: finite differences on coord-separable grids<a class="headerlink" href="#4-backendfd-finite-differences-on-coord-separable-grids" title="Permanent link">¤</a></h2>
<p>The finite-difference backend treats the field as sampled on a structured grid and replaces derivatives by local
stencils. It is only used when the differentiated variable is provided as a tuple of 1D coordinate axes (coord-separable
evaluation).</p>
<h3 id="41-first-derivative-uniform-grid">4.1 First derivative (uniform grid)<a class="headerlink" href="#41-first-derivative-uniform-grid" title="Permanent link">¤</a></h3>
<p>Let <span class="arithmatex">\(x_i=x_0+i h\)</span> for <span class="arithmatex">\(i=0,\dots,N-1\)</span>, and let <span class="arithmatex">\(u_i\approx u(x_i)\)</span>. A common second-order central difference is</p>
<div class="arithmatex">\[
u'(x_i)\approx \frac{u_{i+1}-u_{i-1}}{2h}.
\]</div>
<p>For non-periodic boundaries, one-sided differences are used at endpoints, e.g.</p>
<div class="arithmatex">\[
u'(x_0)\approx \frac{u_1-u_0}{h},\qquad
u'(x_{N-1})\approx \frac{u_{N-1}-u_{N-2}}{h}.
\]</div>
<p>With <code>periodic=True</code>, the stencil wraps around and the central formula applies at all indices (circular shifts).</p>
<h3 id="42-higher-derivatives-and-multi-d-tensor-grids">4.2 Higher derivatives and multi-D tensor grids<a class="headerlink" href="#42-higher-derivatives-and-multi-d-tensor-grids" title="Permanent link">¤</a></h3>
<p>Higher derivatives are obtained by repeated application of the 1D difference operator along the chosen axis.
On a tensor-product grid in <span class="arithmatex">\(d\)</span> dimensions, “differentiate w.r.t. <span class="arithmatex">\(x_i\)</span>” means “apply the 1D stencil along the
corresponding tensor axis while holding the other indices fixed”, i.e. a Kronecker-structured operator of the form</p>
<div class="arithmatex">\[
D_{x_i}\;\approx\; I\otimes\cdots\otimes D \otimes\cdots\otimes I.
\]</div>
<p>The Laplacian is then approximated by the sum of second derivatives along each axis:</p>
<div class="arithmatex">\[
\Delta u \;\approx\; \sum_{i=1}^{d} \frac{\partial^2 u}{\partial x_i^2}.
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The FD backend in Phydrax assumes <strong>uniform spacing</strong> along the differentiated axis and uses <span class="arithmatex">\(h=x_1-x_0\)</span> from the
provided coordinate array.</p>
</div>
<h2 id="5-backendbasis-basis-aware-derivatives-on-structured-grids">5. <code>backend="basis"</code>: basis-aware derivatives on structured grids<a class="headerlink" href="#5-backendbasis-basis-aware-derivatives-on-structured-grids" title="Permanent link">¤</a></h2>
<p>The basis backend differentiates an <strong>implicit reconstruction</strong> of the function along each coord-separable axis:</p>
<ul>
<li>spectral derivatives (Fourier / sine / cosine) via FFT on uniform grids, or</li>
<li>polynomial interpolation derivatives via barycentric differentiation on generic 1D grids.</li>
</ul>
<p>In all cases, the derivative along a chosen axis is a <em>linear map</em> applied to the sampled values along that axis.</p>
<h3 id="51-fourier-spectral-derivatives-basisfourier">5.1 Fourier spectral derivatives (<code>basis="fourier"</code>)<a class="headerlink" href="#51-fourier-spectral-derivatives-basisfourier" title="Permanent link">¤</a></h3>
<p>Assume a periodic interval of length <span class="arithmatex">\(L\)</span> and expand</p>
<div class="arithmatex">\[
u(x) = \sum_{k\in\mathbb{Z}} \hat u_k\,e^{i 2\pi k x/L}.
\]</div>
<p>Then</p>
<div class="arithmatex">\[
u^{(n)}(x) = \sum_{k\in\mathbb{Z}} \left(i\frac{2\pi k}{L}\right)^n \hat u_k\,e^{i 2\pi k x/L}.
\]</div>
<p>On a uniform grid, the coefficients <span class="arithmatex">\(\hat u_k\)</span> are approximated by the FFT, and differentiation becomes elementwise
multiplication by <span class="arithmatex">\(\left(i k\right)^n\)</span> in frequency space (up to the scaling that depends on the physical grid spacing).</p>
<h3 id="52-sinecosine-bases-basissine-cosine">5.2 Sine/cosine bases (<code>basis="sine"</code> / <code>"cosine"</code>)<a class="headerlink" href="#52-sinecosine-bases-basissine-cosine" title="Permanent link">¤</a></h3>
<p>Sine and cosine bases can be understood as Fourier methods applied after symmetry extension:</p>
<ul>
<li>cosine: even extension (cosine series),</li>
<li>sine: odd extension (sine series).</li>
</ul>
<p>The implementation performs the extension to a periodic array, differentiates via FFT in the extended domain, and then
restricts back to the original grid.</p>
<h3 id="53-polynomial-barycentric-differentiation-basispoly">5.3 Polynomial / barycentric differentiation (<code>basis="poly"</code>)<a class="headerlink" href="#53-polynomial-barycentric-differentiation-basispoly" title="Permanent link">¤</a></h3>
<p>Let nodes <span class="arithmatex">\(x_0,\dots,x_{N-1}\)</span> be distinct (not necessarily uniform), with values <span class="arithmatex">\(u_i=u(x_i)\)</span>. The barycentric
weights are</p>
<div class="arithmatex">\[
w_i = \left(\prod_{j\ne i}(x_i-x_j)\right)^{-1}.
\]</div>
<p>Define the first-derivative differentiation matrix <span class="arithmatex">\(D\in\mathbb{R}^{N\times N}\)</span> by</p>
<div class="arithmatex">\[
D_{ij} =
\begin{cases}
\dfrac{w_j}{w_i(x_i-x_j)} &amp; i\ne j,\\
-\sum\limits_{j\ne i} D_{ij} &amp; i=j.
\end{cases}
\]</div>
<p>Then the interpolant derivative at nodes satisfies</p>
<div class="arithmatex">\[
\bigl(p'(x_0),\dots,p'(x_{N-1})\bigr)^\top = D\,(u_0,\dots,u_{N-1})^\top,
\]</div>
<p>where <span class="arithmatex">\(p\)</span> is the unique polynomial interpolant with <span class="arithmatex">\(p(x_i)=u_i\)</span>.
Higher derivatives can be obtained by repeated application of such differentiation matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Polynomial differentiation can be sensitive to node placement for large <span class="arithmatex">\(N\)</span>. For non-periodic smooth problems on
<span class="arithmatex">\([-1,1]\)</span>, Chebyshev-like nodes typically behave far better than uniform nodes.</p>
</div>
<h2 id="6-practical-guidance-what-to-use-when">6. Practical guidance (what to use when)<a class="headerlink" href="#6-practical-guidance-what-to-use-when" title="Permanent link">¤</a></h2>
<p>Common choices:</p>
<ul>
<li><strong>Point collocation (PINN-style)</strong>: <code>backend="ad"</code> (often with <code>mode="reverse"</code> for scalar-valued PDE residuals).</li>
<li><strong>Structured grids / neural operators</strong>:</li>
<li>use <code>backend="basis"</code> for smooth fields matching the basis assumptions (especially periodic Fourier grids),</li>
<li>use <code>backend="fd"</code> for local, stencil-based discretizations or less-smooth signals.</li>
<li><strong>High-order derivatives in one variable</strong> (especially time derivatives of order <span class="arithmatex">\(n\ge 2\)</span>): <code>backend="jet"</code> often
  avoids the overhead of deeply nested Jacobian constructions.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "toc.integrate", "header.autohide", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../_static/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>