
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Phydrax scientific ML and PDE toolkit.">
      
      
        <meta name="author" content="Phydra Labs">
      
      
        <link rel="canonical" href="https://phydra-labs.github.io/phydrax/appendix/physics_constrained_interpolation/">
      
      
        <link rel="prev" href="../differentiation_modes/">
      
      
      
      <link rel="icon" href="../../_static/phydra.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Physics-Constrained Interpolation - Phydrax</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../_static/custom_css.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#physics-constrained-interpolation-overlay-pipeline" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Phydrax" class="md-header__button md-logo" aria-label="Phydrax" data-md-component="logo">
      
  <img src="../../_static/phydra.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phydrax
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Physics-Constrained Interpolation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/phydra-labs/phydrax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    phydra-labs/phydrax
  </div>
</a>

  <a href="https://x.com/PhydraLabs" title="@PhydraLabs" class="md-source md-source--x" aria-label="@PhydraLabs" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"/>
</svg>
    </div>
    
      <div class="md-source__repository md-source__repository--x">
        @PhydraLabs
      </div>
    
  </a>

      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Phydrax" class="md-nav__button md-logo" aria-label="Phydrax" data-md-component="logo">
      
  <img src="../../_static/phydra.png" alt="logo">

    </a>
    Phydrax
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/phydra-labs/phydrax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    phydra-labs/phydrax
  </div>
</a>

  <a href="https://x.com/PhydraLabs" title="@PhydraLabs" class="md-source md-source--x" aria-label="@PhydraLabs" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"/>
</svg>
    </div>
    
      <div class="md-source__repository md-source__repository--x">
        @PhydraLabs
      </div>
    
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../all-of-phydrax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All of Phydrax
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cookbook
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cookbook
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/poisson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Poisson (field learning)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/heat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heat equation (space–time)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/inverse_and_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inverse + hybrid physics–data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/operator_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operator learning (DatasetDomain)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domains and sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_differential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_integrals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrals and measures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constraints and objectives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solvers and training
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/phydrax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Domains
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Domains
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/geometry1d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (1D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/geometry2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (2D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/geometry3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (3D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/composition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Composition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/domain/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/differential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/integral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/linalg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear algebra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/operators/delay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delay
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Constraints
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/continuous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continuous
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/boundary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boundary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/discrete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discrete
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/enforced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforced constraint ansätze
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/cfd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CFD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/solid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/thermal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thermal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constraints/em/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electromagnetics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Neural networks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Neural networks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/architectures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architectures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/structured/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structured
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/wrappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wrappers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/embeddings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/activations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solver
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solver/functional_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional solver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/solver/enforced_constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforced constraint pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/nondimensionalization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nondimensionalization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../differentiation_modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differentiation modes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Physics-Constrained Interpolation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Physics-Constrained Interpolation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a0-setting-and-notation" class="md-nav__link">
    <span class="md-ellipsis">
      A.0. Setting and notation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a1-enforced-constraints-as-constraint-preserving-operators" class="md-nav__link">
    <span class="md-ellipsis">
      A.1. Enforced constraints as constraint-preserving operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a2-boundary-enforced-ansatze" class="md-nav__link">
    <span class="md-ellipsis">
      A.2. Boundary enforced ansätze
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.2. Boundary enforced ansätze">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a21-dirichlet-value-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      A.2.1. Dirichlet (value) constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a22-neumann-normal-derivative-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      A.2.2. Neumann (normal derivative) constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a23-robin-mixed-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      A.2.3. Robin (mixed) constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a24-approximate-distance-field-adf-and-blur" class="md-nav__link">
    <span class="md-ellipsis">
      A.2.4. Approximate distance field (ADF) and blur
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.2.4. Approximate distance field (ADF) and blur">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a241-base-smooth-distance-mesh-adf" class="md-nav__link">
    <span class="md-ellipsis">
      A.2.4.1. Base smooth distance (mesh ADF)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a242-local-adf-blur" class="md-nav__link">
    <span class="md-ellipsis">
      A.2.4.2. Local ADF blur
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a3-piecewise-boundary-constraints-and-blending" class="md-nav__link">
    <span class="md-ellipsis">
      A.3. Piecewise boundary constraints and blending
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.3. Piecewise boundary constraints and blending">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a31-exactness-under-weight-dominance" class="md-nav__link">
    <span class="md-ellipsis">
      A.3.1. Exactness under weight dominance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a32-how-the-weights-are-constructed-mls-bvh" class="md-nav__link">
    <span class="md-ellipsis">
      A.3.2. How the weights are constructed (MLS + BVH)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a33-junction-sets-and-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      A.3.3. Junction sets and compatibility
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a4-the-bvh-structure-and-beam-traversal-packed-aabb-tree" class="md-nav__link">
    <span class="md-ellipsis">
      A.4. The BVH structure and beam traversal (packed AABB tree)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a5-higher-order-initial-constraints-via-a-hermitetaylor-ansatz" class="md-nav__link">
    <span class="md-ellipsis">
      A.5. Higher-order initial constraints via a Hermite/Taylor ansatz
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a6-mixed-boundaryinitial-constraints-and-the-boundary-gate" class="md-nav__link">
    <span class="md-ellipsis">
      A.6. Mixed boundary/initial constraints and the boundary gate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.6. Mixed boundary/initial constraints and the boundary gate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a61-vanishing-order-lemma-derivative-preservation" class="md-nav__link">
    <span class="md-ellipsis">
      A.6.1. Vanishing-order lemma (derivative preservation)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a7-interior-exact-data-satisfaction-anchordata-overlay-stage" class="md-nav__link">
    <span class="md-ellipsis">
      A.7. Interior exact data satisfaction (anchor/data overlay stage)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A.7. Interior exact data satisfaction (anchor/data overlay stage)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a71-interior-anchors-and-optional-tracks" class="md-nav__link">
    <span class="md-ellipsis">
      A.7.1. Interior anchors and (optional) tracks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a72-the-protecting-gate-mz" class="md-nav__link">
    <span class="md-ellipsis">
      A.7.2. The protecting gate M(z)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a73-idw-interpolation-of-the-scaled-residual" class="md-nav__link">
    <span class="md-ellipsis">
      A.7.3. IDW interpolation of the scaled residual
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a74-exact-anchor-satisfaction-snap-rule" class="md-nav__link">
    <span class="md-ellipsis">
      A.7.4. Exact anchor satisfaction (snap rule)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a75-preservation-of-boundary-and-initial-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      A.7.5. Preservation of boundary and initial constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a76-multiple-sources-envelopes-and-coincidence-handling" class="md-nav__link">
    <span class="md-ellipsis">
      A.7.6. Multiple sources, envelopes, and coincidence handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a8-multi-field-pipelines-co-variables-and-topological-ordering" class="md-nav__link">
    <span class="md-ellipsis">
      A.8. Multi-field pipelines, co-variables, and topological ordering
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a9-compatibility-and-scope-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      A.9. Compatibility and scope conditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a10-correspondence-to-the-implementation-terminology" class="md-nav__link">
    <span class="md-ellipsis">
      A.10. Correspondence to the implementation (terminology)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="physics-constrained-interpolation-overlay-pipeline">Physics-Constrained Interpolation (overlay pipeline)<a class="headerlink" href="#physics-constrained-interpolation-overlay-pipeline" title="Permanent link">¤</a></h1>
<p>This appendix formalizes the mathematics behind Phydrax’s <strong>Physics-Constrained Interpolation (PCI)</strong> enforced overlay pipeline:</p>
<ol>
<li>boundary enforced constraints (possibly piecewise, via blending),</li>
<li>initial constraints (possibly higher order in the evolution variable, and gated to preserve boundary constraints),</li>
<li>interior <em>exact</em> data satisfaction via an anchor/data overlay stage while preserving boundary and initial constraints.</li>
</ol>
<p>Here “PCI” refers to the <em>entire</em> staged enforcement map <span class="arithmatex">\(u\mapsto \tilde u\)</span>; the final stage is the
interior anchor/data overlay.</p>
<p>The implementation corresponds to the staging performed by <code>EnforcedConstraintPipeline</code> / <code>EnforcedConstraintPipelines</code>,
the enforced ansätze in <code>phydrax.constraints</code> (e.g. Dirichlet/Neumann/Robin), the BVH-accelerated weight construction
used for boundary blending, and the IDW-based interior anchor overlay.</p>
<h2 id="a0-setting-and-notation">A.0. Setting and notation<a class="headerlink" href="#a0-setting-and-notation" title="Permanent link">¤</a></h2>
<p>Let the computational domain be a product:</p>
<div class="arithmatex">\[
\mathcal D \;=\; \prod_{\ell\in\mathcal L}\mathcal D_\ell,
\]</div>
<p>where <span class="arithmatex">\(\mathcal L\)</span> is a finite set of <em>labels</em> (e.g. <span class="arithmatex">\(\mathcal L=\lbrace x,t\rbrace\)</span> for space–time).
We write a point as <span class="arithmatex">\(z=(z_\ell)_{\ell\in\mathcal L}\)</span>.</p>
<p>A field is a map <span class="arithmatex">\(u:\mathcal D\to \mathbb R^C\)</span>. Phydrax represents a parameterized base field
<span class="arithmatex">\(u_\theta\)</span> (a <code>DomainFunction</code>) and produces an <em>enforced</em> field <span class="arithmatex">\(\tilde u_\theta\)</span> by applying
a staged transformation:</p>
<div class="arithmatex">\[
\mathcal P:\ u \mapsto \tilde u.
\]</div>
<p>We consider three classes of enforced requirements:</p>
<ul>
<li><strong>Boundary constraints</strong>: conditions on a boundary subset <span class="arithmatex">\(S_B\subset \mathcal D\)</span>, typically
  <span class="arithmatex">\(S_B=\partial\Omega\times \prod_{\ell\neq x}\mathcal D_\ell\)</span> for a geometry factor <span class="arithmatex">\(\Omega\)</span>.</li>
<li><strong>Initial constraints</strong>: conditions on a fixed slice <span class="arithmatex">\(S_I=\lbrace t=t_0\rbrace\times \prod_{\ell\neq t}\mathcal D_\ell\)</span>.
  Higher-order initial constraints fix <span class="arithmatex">\(\partial_t^k u(\cdot,t_0)\)</span> for <span class="arithmatex">\(k\le K\)</span>.</li>
<li><strong>Interior data</strong>: anchor requirements <span class="arithmatex">\(\tilde u(z_i)=y_i\)</span> for prescribed interior points <span class="arithmatex">\(z_i\in\mathcal D\)</span>,
  optionally including time-dependent tracks <span class="arithmatex">\(\tilde u(x_m,t)=y_m(t)\)</span> for sensors <span class="arithmatex">\(x_m\)</span>.</li>
</ul>
<p>The central design goal is <strong>constraint preservation by construction</strong>:
later stages must not re-violate earlier enforced constraints.</p>
<h2 id="a1-enforced-constraints-as-constraint-preserving-operators">A.1. Enforced constraints as constraint-preserving operators<a class="headerlink" href="#a1-enforced-constraints-as-constraint-preserving-operators" title="Permanent link">¤</a></h2>
<p>Let <span class="arithmatex">\(\mathcal F\)</span> be a function space over <span class="arithmatex">\(\mathcal D\)</span>. An enforced constraint defines a subset
<span class="arithmatex">\(\mathcal C\subset\mathcal F\)</span> (e.g. functions satisfying Dirichlet boundary conditions).</p>
<p>An operator <span class="arithmatex">\(\mathcal T:\mathcal F\to\mathcal F\)</span> is <strong><span class="arithmatex">\(\mathcal C\)</span>-preserving</strong> if:</p>
<div class="arithmatex">\[
u\in\mathcal C\quad\Rightarrow\quad \mathcal T(u)\in\mathcal C.
\]</div>
<p>The overlay pipeline is a composition:</p>
<div class="arithmatex">\[
\tilde u \;=\; \mathcal T_3\bigl(\mathcal T_2(\mathcal T_1(u))\bigr)
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(\mathcal T_1\)</span> enforces boundary constraints (possibly piecewise-blended),</li>
<li><span class="arithmatex">\(\mathcal T_2\)</span> enforces initial constraints but is designed to be boundary-preserving,</li>
<li><span class="arithmatex">\(\mathcal T_3\)</span> enforces interior data while preserving boundary and initial constraints
  (including derivative constraints up to specified orders).</li>
</ul>
<p>The remaining sections specify concrete constructions and the invariance proofs.</p>
<h2 id="a2-boundary-enforced-ansatze">A.2. Boundary enforced ansätze<a class="headerlink" href="#a2-boundary-enforced-ansatze" title="Permanent link">¤</a></h2>
<p>Let <span class="arithmatex">\(\Omega\subset\mathbb R^d\)</span> be a geometry factor with boundary <span class="arithmatex">\(\partial\Omega\)</span>.
Assume a signed distance–like function <span class="arithmatex">\(\phi:\Omega\to\mathbb R\)</span> satisfying <span class="arithmatex">\(\phi=0\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>,
and an outward unit normal <span class="arithmatex">\(n\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>.</p>
<p>The statements below are written in an ideal smooth setting; in practice Phydrax uses an
approximate distance function and numerically defined boundary normals. Exactness claims
should be interpreted as exact for the idealized <span class="arithmatex">\(\phi,n\)</span>, and “up to numerical tolerance”
in typical discretized settings.</p>
<h3 id="a21-dirichlet-value-constraints">A.2.1. Dirichlet (value) constraints<a class="headerlink" href="#a21-dirichlet-value-constraints" title="Permanent link">¤</a></h3>
<p>Given a target <span class="arithmatex">\(g:\partial\Omega\to\mathbb R^C\)</span>, define:</p>
<div class="arithmatex">\[
u^\star(x)\;=\; g(x) + \phi(x)\,\bigl(u(x)-g(x)\bigr).
\]</div>
<p><strong>Proposition A.1 (Dirichlet exactness).</strong> If <span class="arithmatex">\(\phi=0\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>, then <span class="arithmatex">\(u^\star=g\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>.</p>
<p><em>Proof.</em> For <span class="arithmatex">\(x\in\partial\Omega\)</span>, <span class="arithmatex">\(\phi(x)=0\)</span> implies <span class="arithmatex">\(u^\star(x)=g(x)\)</span>. <span class="arithmatex">\(\square\)</span></p>
<h3 id="a22-neumann-normal-derivative-constraints">A.2.2. Neumann (normal derivative) constraints<a class="headerlink" href="#a22-neumann-normal-derivative-constraints" title="Permanent link">¤</a></h3>
<p>Given a target <span class="arithmatex">\(g:\partial\Omega\to\mathbb R^C\)</span> for <span class="arithmatex">\(\partial_n u=g\)</span>, define:</p>
<div class="arithmatex">\[
u^\star \;=\; u + \frac{\phi}{\partial_n\phi}\,\bigl(g-\partial_n u\bigr).
\]</div>
<p><strong>Proposition A.2 (Neumann exactness).</strong> Assume <span class="arithmatex">\(u,\phi\)</span> are differentiable and <span class="arithmatex">\(\partial_n\phi\neq 0\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>.
Then <span class="arithmatex">\(\partial_n u^\star=g\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>.</p>
<p><em>Proof.</em> Differentiate along <span class="arithmatex">\(n\)</span>:</p>
<div class="arithmatex">\[
\partial_n u^\star
=\partial_n u + \partial_n\left(\frac{\phi}{\partial_n\phi}\right)\bigl(g-\partial_n u\bigr)
+ \frac{\phi}{\partial_n\phi}\bigl(\partial_n g - \partial_n\partial_n u\bigr).
\]</div>
<p>On <span class="arithmatex">\(\partial\Omega\)</span>, <span class="arithmatex">\(\phi=0\)</span> annihilates the last term. Moreover,</p>
<div class="arithmatex">\[
\partial_n\left(\frac{\phi}{\partial_n\phi}\right)
=\frac{\partial_n\phi}{\partial_n\phi}+\phi\cdot(\cdots)=1
\quad\text{on }\partial\Omega.
\]</div>
<p>Hence <span class="arithmatex">\(\partial_n u^\star=\partial_n u + (g-\partial_n u)=g\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>. <span class="arithmatex">\(\square\)</span></p>
<h3 id="a23-robin-mixed-constraints">A.2.3. Robin (mixed) constraints<a class="headerlink" href="#a23-robin-mixed-constraints" title="Permanent link">¤</a></h3>
<p>For <span class="arithmatex">\(a\,u + b\,\partial_n u = g\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>, one may use the analogous correction:</p>
<div class="arithmatex">\[
u^\star \;=\; u + \frac{\phi}{b\,\partial_n\phi}\,\bigl(g-a\,u-b\,\partial_n u\bigr),
\]</div>
<p>under the nondegeneracy assumption <span class="arithmatex">\(b\,\partial_n\phi\neq 0\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>.
The proof is the same as Proposition A.2: the correction term vanishes on the boundary but has
the correct first normal derivative to cancel the residual of the Robin operator.</p>
<h3 id="a24-approximate-distance-field-adf-and-blur">A.2.4. Approximate distance field (ADF) and blur<a class="headerlink" href="#a24-approximate-distance-field-adf-and-blur" title="Permanent link">¤</a></h3>
<p>PCI relies on a signed distance–like function <span class="arithmatex">\(\phi\)</span> to build boundary factors and normals.
Phydrax constructs a smooth <strong>approximate distance field (ADF)</strong> from a mesh and, by default,
applies a local Gaussian blur to improve stability of downstream derivatives.</p>
<h4 id="a241-base-smooth-distance-mesh-adf">A.2.4.1. Base smooth distance (mesh ADF)<a class="headerlink" href="#a241-base-smooth-distance-mesh-adf" title="Permanent link">¤</a></h4>
<p>Let <span class="arithmatex">\(\mathcal M\)</span> be a triangulated surface defining <span class="arithmatex">\(\partial\Omega\)</span>. For each query point <span class="arithmatex">\(x\)</span>,
Phydrax computes a smooth proxy distance by combining candidate triangle distances with a soft-min:</p>
<div class="arithmatex">\[
d(x)\;\approx\;\operatorname{softmin}_\beta\{\,d_T(x)\,\}_{T\in\mathcal C(x)},
\]</div>
<p>where <span class="arithmatex">\(d_T(x)\)</span> is the point-to-triangle distance and <span class="arithmatex">\(\mathcal C(x)\)</span> is a BVH-selected candidate
set (beam traversal of a packed AABB tree). The softness parameter <span class="arithmatex">\(\beta&gt;0\)</span> controls the
sharpness of the soft-min; smaller <span class="arithmatex">\(\beta\)</span> yields a smoother blend of nearby triangle distances.</p>
<p>For 2D geometries built from CAD, Phydrax extrudes the mesh to 3D and evaluates the 3D ADF away
from end caps so that the resulting distance coincides with the 2D boundary distance on the
side walls.</p>
<p>An optional <strong>squash</strong> transform can be applied:</p>
<div class="arithmatex">\[
\rho(s)=\delta\,\operatorname{tanh}\!\left(\frac{s}{\delta}\right),
\]</div>
<p>which is linear near <span class="arithmatex">\(s=0\)</span> but saturates in the interior to limit curvature. The <em>unsquashed</em>
field (pre-<span class="arithmatex">\(\operatorname{tanh}\)</span>) is exposed as <code>adf_orig</code>.</p>
<h4 id="a242-local-adf-blur">A.2.4.2. Local ADF blur<a class="headerlink" href="#a242-local-adf-blur" title="Permanent link">¤</a></h4>
<p>Given a base field <span class="arithmatex">\(\phi_{\text{orig}}\)</span> (typically <code>adf_orig</code>), the blurred ADF is defined by
sampling in a local neighborhood:</p>
<div class="arithmatex">\[
\phi_{\text{blur}}(x)
=
\frac{\phi_{\text{orig}}(x)+\sum_{i=1}^m w_i(x)\,\phi_{\text{orig}}(x+r(x)u_i)}
{1+\sum_{i=1}^m w_i(x)}.
\]</div>
<p>Here <span class="arithmatex">\((u_i)\)</span> are deterministic offsets on the unit disk (2D Fibonacci disk) or unit ball
(3D Fibonacci sphere with radial stratification). The radius is adaptive:</p>
<div class="arithmatex">\[
r(x)=\max\!\bigl(\sqrt{\phi_{\text{orig}}(x)^2+\varepsilon^2}-\varepsilon,\ r_{\min}\bigr),
\]</div>
<p>and the Gaussian weights are</p>
<div class="arithmatex">\[
w_i(x)=\exp\!\left(-\frac{\|r(x)\,u_i\|^2}{2(\sigma\,r(x))^2+\varepsilon}\right),
\]</div>
<p>with <span class="arithmatex">\(\sigma=\texttt{sigma_scale}\)</span>. The parameters <span class="arithmatex">\((\varepsilon,r_{\min})\)</span> prevent numerical
instabilities and collapse of the kernel near the boundary.</p>
<p><strong>Implementation note.</strong> By default, <code>geom.adf</code> is set to the blurred field
<span class="arithmatex">\(\phi_{\text{blur}}=\texttt{adf_blur}(\texttt{adf_orig})\)</span>, while <code>adf_orig</code> provides the
unsquashed base field. Thus enforced boundary ansätze use the blurred ADF by default.</p>
<h2 id="a3-piecewise-boundary-constraints-and-blending">A.3. Piecewise boundary constraints and blending<a class="headerlink" href="#a3-piecewise-boundary-constraints-and-blending" title="Permanent link">¤</a></h2>
<p>Boundary conditions are commonly specified piecewise on disjoint boundary subsets
<span class="arithmatex">\(\Gamma_1,\dots,\Gamma_m\subset\partial\Omega\)</span>. For each <span class="arithmatex">\(\Gamma_i\)</span> one can build an ansatz
<span class="arithmatex">\(u_i^\star=\mathcal H_i(u)\)</span> that satisfies the desired condition on <span class="arithmatex">\(\Gamma_i\)</span>.
The pipeline then combines them into a single enforced field by weighted blending:</p>
<div class="arithmatex">\[
u_B(x)
=
\frac{\sum_{i=1}^m w_i(x)\,u_i^\star(x)\;+\;w_{\text{rem}}(x)\,u(x)}
{\sum_{i=1}^m w_i(x)\;+\;w_{\text{rem}}(x)}.
\]</div>
<p>The optional remainder weight <span class="arithmatex">\(w_{\text{rem}}\)</span> is supported on the complement of the union
of the boundary subsets and prevents subset constraints from “leaking” to other segments.</p>
<h3 id="a31-exactness-under-weight-dominance">A.3.1. Exactness under weight dominance<a class="headerlink" href="#a31-exactness-under-weight-dominance" title="Permanent link">¤</a></h3>
<p>To make the blend exact on each piece, it suffices that the weights <em>dominate</em> near the corresponding subset.</p>
<p><strong>Assumption A.1 (dominant weights).</strong> For each <span class="arithmatex">\(k\)</span>, <span class="arithmatex">\(w_k(x)\to +\infty\)</span> as <span class="arithmatex">\(x\to\Gamma_k\)</span>, while every
<span class="arithmatex">\(w_j\)</span> with <span class="arithmatex">\(j\neq k\)</span> and <span class="arithmatex">\(w_{\text{rem}}\)</span> remain bounded in a neighborhood of <span class="arithmatex">\(\Gamma_k\)</span>.</p>
<p><strong>Proposition A.3 (piecewise exactness).</strong> Under Assumption A.1 and continuity of <span class="arithmatex">\(u_i^\star\)</span>, the blended field has
the same boundary trace as the dominant piece on <span class="arithmatex">\(\Gamma_k\)</span> (i.e. <span class="arithmatex">\(u_B\to u_k^\star\)</span> as <span class="arithmatex">\(x\to\Gamma_k\)</span> away from
junction sets where multiple pieces meet):</p>
<div class="arithmatex">\[
u_B|_{\Gamma_k} = u_k^\star|_{\Gamma_k}.
\]</div>
<p>Consequently, if <span class="arithmatex">\(u_k^\star\)</span> satisfies the desired enforced boundary condition on <span class="arithmatex">\(\Gamma_k\)</span>, so does <span class="arithmatex">\(u_B\)</span>.</p>
<p><em>Proof.</em> Write <span class="arithmatex">\(u_B=(w_k u_k^\star + R)/(w_k+r)\)</span> where <span class="arithmatex">\(R=\sum_{j\neq k}w_j u_j^\star+w_{\text{rem}}u\)</span>
and <span class="arithmatex">\(r=\sum_{j\neq k}w_j+w_{\text{rem}}\)</span>. By Assumption A.1, <span class="arithmatex">\(R/w_k\to 0\)</span> and <span class="arithmatex">\(r/w_k\to 0\)</span> as <span class="arithmatex">\(x\to\Gamma_k\)</span>.
Thus <span class="arithmatex">\(u_B\to u_k^\star\)</span> as <span class="arithmatex">\(x\to\Gamma_k\)</span> (and hence their boundary traces agree). <span class="arithmatex">\(\square\)</span></p>
<h3 id="a32-how-the-weights-are-constructed-mls-bvh">A.3.2. How the weights are constructed (MLS + BVH)<a class="headerlink" href="#a32-how-the-weights-are-constructed-mls-bvh" title="Permanent link">¤</a></h3>
<p>In Phydrax, each <span class="arithmatex">\(w_i\)</span> is derived from a distance-to-subset proxy <span class="arithmatex">\(\rho_i(x)\ge 0\)</span> with <span class="arithmatex">\(\rho_i=0\)</span> on <span class="arithmatex">\(\Gamma_i\)</span>,
typically via an inverse-square law <span class="arithmatex">\(w_i(x)\propto (\rho_i(x)+\varepsilon)^{-2}\)</span>.</p>
<p>The proxy <span class="arithmatex">\(\rho_i\)</span> is computed from a dense reference sample <span class="arithmatex">\(P=\lbrace p_j\rbrace\subset\Gamma_i\)</span> and associated outward normals
<span class="arithmatex">\(\lbrace n_j\rbrace\)</span>. For a query point <span class="arithmatex">\(x\)</span>, the implementation computes an oriented MLS projection distance</p>
<div class="arithmatex">\[
f(x)=\sum_{j\in\mathcal N(x)} \alpha_j(x)\,\langle n_j,\,x-p_j\rangle,
\]</div>
<p>where <span class="arithmatex">\(\alpha_j(x)\)</span> are nonnegative weights concentrating on nearby points and penalizing normal mismatch.
Then <span class="arithmatex">\(\rho(x)\)</span> is obtained from <span class="arithmatex">\(f(x)\)</span> by a smooth nonnegative transformation (a softplus-based absolute distance).</p>
<p>A naive MLS evaluation would require scanning all reference points. Instead, neighbor candidates <span class="arithmatex">\(\mathcal N(x)\)</span>
are chosen using a static AABB BVH (bounding volume hierarchy) built over <span class="arithmatex">\(P\)</span>. The BVH provides a fast approximate
nearest-neighbor primitive: it restricts the MLS sum to a candidate set. If that candidate set contains all points
with non-negligible kernel weight (in a chosen tolerance sense), the BVH-accelerated estimate approximates the full
MLS distance; in the limit of exhaustive search (beam width <span class="arithmatex">\(\to\infty\)</span>), it matches the full neighborhood evaluation.</p>
<h3 id="a33-junction-sets-and-compatibility">A.3.3. Junction sets and compatibility<a class="headerlink" href="#a33-junction-sets-and-compatibility" title="Permanent link">¤</a></h3>
<p>The “dominant weight” argument above is valid away from points where multiple pieces touch. Define the junction set:</p>
<div class="arithmatex">\[
J \;=\; \bigcup_{i\neq j}\left(\overline{\Gamma_i}\cap\overline{\Gamma_j}\right).
\]</div>
<p>At points of <span class="arithmatex">\(J\)</span>, distances (and thus weights) for two or more pieces may vanish simultaneously, so no single piece
need dominate. Rigorous <em>everywhere</em> exactness therefore requires additional compatibility or a priority rule:</p>
<ul>
<li>If the boundary data are compatible on <span class="arithmatex">\(J\)</span> (e.g. Dirichlet targets agree on overlaps), then any limiting blend yields
  the same boundary trace there.</li>
<li>If the data are incompatible on <span class="arithmatex">\(J\)</span>, then no single-valued field can satisfy all piecewise constraints simultaneously
  on <span class="arithmatex">\(J\)</span>; any construction must either (i) define a priority convention on <span class="arithmatex">\(J\)</span>, or (ii) accept that exactness is claimed
  only on each <span class="arithmatex">\(\Gamma_k\setminus J\)</span> (a standard relaxation since <span class="arithmatex">\(J\)</span> is lower-dimensional).</li>
</ul>
<h2 id="a4-the-bvh-structure-and-beam-traversal-packed-aabb-tree">A.4. The BVH structure and beam traversal (packed AABB tree)<a class="headerlink" href="#a4-the-bvh-structure-and-beam-traversal-packed-aabb-tree" title="Permanent link">¤</a></h2>
<p>Phydrax’s BVH is a packed binary AABB tree with:</p>
<ul>
<li>node arrays storing bounding boxes and child links,</li>
<li>fixed-size leaf payload arrays storing item indices (with padding),</li>
<li>a beam traversal that keeps the best <span class="arithmatex">\(B\)</span> nodes according to AABB lower bounds.</li>
</ul>
<p>Mathematically, for a node with AABB <span class="arithmatex">\([b_{\text{min}},b_{\text{max}}]\subset\mathbb R^d\)</span>, the squared distance lower bound
from a query <span class="arithmatex">\(x\)</span> is:</p>
<div class="arithmatex">\[
d^2_{\text{AABB}}(x,[b_{\text{min}},b_{\text{max}}])
=
\sum_{k=1}^d \bigl(\mathop{\text{max}}\left\lbrace 0,\,b_{\text{min},k}-x_k,\,x_k-b_{\text{max},k}\right\rbrace\bigr)^2.
\]</div>
<p>This is a lower bound on the squared distance to any point inside the node’s subtree.</p>
<p>Beam traversal uses this bound to choose a small set of candidate leaves, then returns their payload items. In the
limit of infinite beam width (or in settings where the relevant neighbors always lie within the selected leaves),
the BVH-accelerated method is identical to an exact neighborhood search. For finite beam width it is an approximation,
and its accuracy depends on whether the candidate set captures the effective support of the MLS kernel.</p>
<h2 id="a5-higher-order-initial-constraints-via-a-hermitetaylor-ansatz">A.5. Higher-order initial constraints via a Hermite/Taylor ansatz<a class="headerlink" href="#a5-higher-order-initial-constraints-via-a-hermitetaylor-ansatz" title="Permanent link">¤</a></h2>
<p>Let <span class="arithmatex">\(t\)</span> be the evolution variable with an initial slice <span class="arithmatex">\(t=t_0\)</span>. Suppose we want to enforce, for a given
integer <span class="arithmatex">\(K\ge 0\)</span>:</p>
<div class="arithmatex">\[
\partial_t^k u(\cdot,t_0)=g_k(\cdot),\qquad k=0,1,\dots,K.
\]</div>
<p>Define the truncated Taylor polynomial:</p>
<div class="arithmatex">\[
P_K(t)=\sum_{k=0}^{K}\frac{(t-t_0)^k}{k!}\,g_k,
\]</div>
<p>and define the enforced initial ansatz:</p>
<div class="arithmatex">\[
u_I(t)=P_K(t) + (t-t_0)^{K+1}\bigl(u(t)-P_K(t)\bigr).
\]</div>
<p><strong>Proposition A.4 (exact initial derivatives).</strong> Assume <span class="arithmatex">\(u\)</span> is <span class="arithmatex">\(K+1\)</span> times differentiable in <span class="arithmatex">\(t\)</span>.
Then <span class="arithmatex">\(\partial_t^k u_I(\cdot,t_0)=g_k(\cdot)\)</span> for <span class="arithmatex">\(k=0,\dots,K\)</span>.</p>
<p><em>Proof.</em> The correction term <span class="arithmatex">\((t-t_0)^{K+1}(u-P_K)\)</span> has a factor <span class="arithmatex">\((t-t_0)^{K+1}\)</span>, so all of its derivatives
up to order <span class="arithmatex">\(K\)</span> vanish at <span class="arithmatex">\(t=t_0\)</span>. Therefore <span class="arithmatex">\(\partial_t^k u_I(t_0)=\partial_t^k P_K(t_0)=g_k\)</span>. <span class="arithmatex">\(\square\)</span></p>
<p>This construction is used as the “initial target overlay” when multiple initial derivative targets are specified.</p>
<h2 id="a6-mixed-boundaryinitial-constraints-and-the-boundary-gate">A.6. Mixed boundary/initial constraints and the boundary gate<a class="headerlink" href="#a6-mixed-boundaryinitial-constraints-and-the-boundary-gate" title="Permanent link">¤</a></h2>
<p>Boundary and initial sets intersect (e.g. <span class="arithmatex">\(\partial\Omega\times\lbrace t_0\rbrace\)</span>). In PDE theory, exact satisfaction of
both requires <em>compatibility conditions</em> on the intersection; incompatible data cannot be enforced simultaneously.</p>
<p>The pipeline resolves the interaction by a staged priority:</p>
<ol>
<li>Enforce boundary constraints first to obtain <span class="arithmatex">\(u_B\)</span>.</li>
<li>Compute an initial-enforced candidate <span class="arithmatex">\(u_{\text{init}}\)</span> from <span class="arithmatex">\(u_B\)</span>.</li>
<li>Blend the update through a <strong>boundary gate</strong> <span class="arithmatex">\(\gamma\)</span> that vanishes on the constrained boundary.</li>
</ol>
<div class="arithmatex">\[
u_{BI} \;=\; u_B + \gamma\,(u_{\text{init}}-u_B).
\]</div>
<p>This guarantees boundary constraints remain satisfied by construction because the update is identically zero on the
boundary. The gate is chosen to vanish to sufficiently high order to preserve boundary constraints involving spatial
derivatives up to a prescribed order.</p>
<p><strong>Remark (initial exactness tradeoff).</strong> If the initial-enforcement map produces a candidate with
<span class="arithmatex">\(u_{\text{init}}(\cdot,t_0)=g_0(\cdot)\)</span>, then on the initial slice:</p>
<div class="arithmatex">\[
u_{BI}(\cdot,t_0)=u_B(\cdot,t_0) + \gamma(\cdot)\,\bigl(g_0-u_B(\cdot,t_0)\bigr).
\]</div>
<p>Unless <span class="arithmatex">\(\gamma\equiv 1\)</span> away from the boundary (or <span class="arithmatex">\(u_B(\cdot,t_0)=g_0\)</span> already), this blend relaxes <em>exact</em> initial
enforcement near the boundary in order to preserve boundary constraints. In Phydrax’s implementation, <span class="arithmatex">\(\gamma\)</span> is smooth,
vanishes to high order on the boundary, and tends to <span class="arithmatex">\(1\)</span> with increasing distance, so initial constraints are typically
satisfied approximately away from the boundary (subject to compatibility at <span class="arithmatex">\(\partial\Omega\times\lbrace t_0\rbrace\)</span>).</p>
<h3 id="a61-vanishing-order-lemma-derivative-preservation">A.6.1. Vanishing-order lemma (derivative preservation)<a class="headerlink" href="#a61-vanishing-order-lemma-derivative-preservation" title="Permanent link">¤</a></h3>
<p>Let <span class="arithmatex">\(s\)</span> be a local normal coordinate to <span class="arithmatex">\(\partial\Omega\)</span> (e.g. <span class="arithmatex">\(s=\phi(x)\)</span>). Consider an update:</p>
<div class="arithmatex">\[
u_{\text{new}} = u + \gamma(s)\,(v-u),
\]</div>
<p>where <span class="arithmatex">\(\gamma(0)=0\)</span>.</p>
<p><strong>Lemma A.5 (preservation by high-order vanishing).</strong> If <span class="arithmatex">\(\gamma(s)=\mathcal O(|s|^{m})\)</span> as <span class="arithmatex">\(s\to 0\)</span>, then
for every integer <span class="arithmatex">\(0\le k\le m-1\)</span>:</p>
<div class="arithmatex">\[
\partial_s^k u_{\text{new}}(0) = \partial_s^k u(0),
\]</div>
<p>provided the derivatives exist.</p>
<p><em>Proof.</em> Write <span class="arithmatex">\(u_{\text{new}}-u=\gamma(s)\,w(s)\)</span> with <span class="arithmatex">\(w=v-u\)</span>. By Leibniz’ rule, each <span class="arithmatex">\(\partial_s^k\bigl(\gamma w\bigr)\)</span>
is a sum of terms <span class="arithmatex">\((\partial_s^j\gamma)(\partial_s^{k-j}w)\)</span>. If <span class="arithmatex">\(\gamma=\mathcal O(|s|^m)\)</span>, then <span class="arithmatex">\(\partial_s^j\gamma(0)=0\)</span>
for all <span class="arithmatex">\(j\le m-1\)</span>, implying all such terms vanish at <span class="arithmatex">\(s=0\)</span> when <span class="arithmatex">\(k\le m-1\)</span>. <span class="arithmatex">\(\square\)</span></p>
<p>Thus, by choosing <span class="arithmatex">\(\gamma\)</span> to vanish to order <span class="arithmatex">\(m\ge K+1\)</span>, the blend preserves boundary operators involving derivatives
up to order <span class="arithmatex">\(K\)</span> in the boundary-normal direction.</p>
<h2 id="a7-interior-exact-data-satisfaction-anchordata-overlay-stage">A.7. Interior exact data satisfaction (anchor/data overlay stage)<a class="headerlink" href="#a7-interior-exact-data-satisfaction-anchordata-overlay-stage" title="Permanent link">¤</a></h2>
<p>After boundary and initial staging in the PCI pipeline, the interior anchor/data overlay enforces interior data exactly
at specified anchors/tracks while preserving boundary and initial constraints (including derivative constraints up to
specified orders).</p>
<h3 id="a71-interior-anchors-and-optional-tracks">A.7.1. Interior anchors and (optional) tracks<a class="headerlink" href="#a71-interior-anchors-and-optional-tracks" title="Permanent link">¤</a></h3>
<p><strong>Anchor mode.</strong> Given points <span class="arithmatex">\(z_i\in\mathcal D\)</span> and targets <span class="arithmatex">\(y_i\in\mathbb R^C\)</span>, we require:</p>
<div class="arithmatex">\[
\tilde u(z_i)=y_i.
\]</div>
<p><strong>Sensor-track mode.</strong> Given fixed sensors <span class="arithmatex">\(x_m\)</span> and time-dependent observations <span class="arithmatex">\(y_m(t)\)</span>, we require:</p>
<div class="arithmatex">\[
\tilde u(x_m,t)=y_m(t).
\]</div>
<p>where <span class="arithmatex">\(y_m\)</span> is represented by an interpolant (e.g. a cubic Hermite spline in time).</p>
<h3 id="a72-the-protecting-gate-mz">A.7.2. The protecting gate M(z)<a class="headerlink" href="#a72-the-protecting-gate-mz" title="Permanent link">¤</a></h3>
<p>Let boundary constraints for a geometry label <span class="arithmatex">\(\ell=x\)</span> involve derivatives up to order <span class="arithmatex">\(K_x\)</span> (e.g. Dirichlet: <span class="arithmatex">\(K_x=0\)</span>,
Neumann/Robin: <span class="arithmatex">\(K_x=1\)</span>). Let initial constraints fix time derivatives up to order <span class="arithmatex">\(K_t\)</span>.</p>
<p>Define a gate:</p>
<div class="arithmatex">\[
M(z)
=
\Bigl(\prod_{\ell\in\mathcal B} |\phi_\ell(z_\ell)|^{K_\ell+1}\Bigr)
\cdot (\mathop{\text{max}}(t-t_0,0))^{K_t+1},
\]</div>
<p>with <span class="arithmatex">\(\mathcal B\subseteq \mathcal L\)</span> the set of geometry labels with boundary constraints and <span class="arithmatex">\(\phi_\ell\)</span> a signed
distance–like function for that geometry factor.</p>
<p>On domains where <span class="arithmatex">\(t\ge t_0\)</span> identically, <span class="arithmatex">\(\mathop{\text{max}}(t-t_0,0)=t-t_0\)</span>, so this reduces to <span class="arithmatex">\((t-t_0)^{K_t+1}\)</span>. The <span class="arithmatex">\(\text{max}\)</span> form
is convenient to keep <span class="arithmatex">\(M\)</span> nonnegative and real-valued.</p>
<p>Key properties:</p>
<ul>
<li><span class="arithmatex">\(M(z)=0\)</span> on constrained boundary sets (where <span class="arithmatex">\(\phi_\ell=0\)</span>),</li>
<li><span class="arithmatex">\(M(z)=0\)</span> on the initial slice <span class="arithmatex">\(t=t_0\)</span>,</li>
<li><span class="arithmatex">\(M\)</span> vanishes to high enough order so that derivatives of <span class="arithmatex">\(M(\cdot)h(\cdot)\)</span> up to the constrained orders also vanish
  on those sets (formalized below).</li>
</ul>
<p>Anchors/tracks are required to satisfy <span class="arithmatex">\(M(z_i)&gt;0\)</span>; placing an interior anchor on a constrained set is incompatible with
the goal of preserving those enforced constraints.</p>
<h3 id="a73-idw-interpolation-of-the-scaled-residual">A.7.3. IDW interpolation of the <em>scaled residual</em><a class="headerlink" href="#a73-idw-interpolation-of-the-scaled-residual" title="Permanent link">¤</a></h3>
<p>Let <span class="arithmatex">\(u\)</span> be the field after boundary/initial stages. For anchors <span class="arithmatex">\(z_i\)</span> with targets <span class="arithmatex">\(y_i\)</span>, define scaled residuals:</p>
<div class="arithmatex">\[
r_i = \frac{y_i - u(z_i)}{M(z_i)}.
\]</div>
<p>Define a (possibly anisotropic) squared distance on <span class="arithmatex">\(\mathcal D\)</span> with per-label lengthscales <span class="arithmatex">\(\ell_\alpha&gt;0\)</span>:</p>
<div class="arithmatex">\[
d(z,z_i)^2=\sum_{\alpha\in\mathcal L}\left\lVert\frac{z_\alpha-z_{i,\alpha}}{\ell_\alpha}\right\rVert^2.
\]</div>
<p>For an IDW exponent <span class="arithmatex">\(p&gt;0\)</span>, define weights:</p>
<div class="arithmatex">\[
w_i(z)\propto \bigl(d(z,z_i)^2+\varepsilon\bigr)^{-p/2},
\qquad \sum_i w_i(z)=1.
\]</div>
<p>The interior overlay defines:</p>
<div class="arithmatex">\[
\tilde u(z)
=
u(z) + M(z)\sum_i w_i(z)\,r_i.
\]</div>
<p>This is an interpolation of the scaled residual field <span class="arithmatex">\(r\)</span>, multiplied by the protecting gate <span class="arithmatex">\(M\)</span>.</p>
<h3 id="a74-exact-anchor-satisfaction-snap-rule">A.7.4. Exact anchor satisfaction (snap rule)<a class="headerlink" href="#a74-exact-anchor-satisfaction-snap-rule" title="Permanent link">¤</a></h3>
<p>In exact arithmetic, the IDW interpolant need not satisfy <span class="arithmatex">\(w_i(z_i)=1\)</span> (it typically satisfies this only in the
limit <span class="arithmatex">\(\varepsilon\to 0\)</span> with exact evaluation). The implementation therefore uses a <em>snap rule</em>: if a query is closer
than a prescribed threshold <span class="arithmatex">\(\varepsilon_{\text{snap}}\)</span> to an anchor, the weight becomes one-hot.</p>
<p><strong>Proposition A.6 (exactness at anchors under snapping).</strong> Suppose <span class="arithmatex">\(M(z_k)&gt;0\)</span> and <span class="arithmatex">\(w_k(z_k)=1\)</span>. Then <span class="arithmatex">\(\tilde u(z_k)=y_k\)</span>.</p>
<p><em>Proof.</em> Evaluate the overlay at <span class="arithmatex">\(z=z_k\)</span>:</p>
<p>[
\begin{aligned}
\tilde u(z_k) &amp;= u(z_k) + M(z_k)\,r_k \
&amp;= u(z_k) + M(z_k)\frac{y_k-u(z_k)}{M(z_k)} \
&amp;= y_k.
\end{aligned}
]
<span class="arithmatex">\(\square\)</span></p>
<h3 id="a75-preservation-of-boundary-and-initial-constraints">A.7.5. Preservation of boundary and initial constraints<a class="headerlink" href="#a75-preservation-of-boundary-and-initial-constraints" title="Permanent link">¤</a></h3>
<p>The interior correction has the form <span class="arithmatex">\(\Delta u(z)=M(z)\,h(z)\)</span> where <span class="arithmatex">\(h(z)=\sum_i w_i(z)r_i\)</span>.</p>
<p><strong>Lemma A.7 (vanishing factor kills derivatives).</strong> Let <span class="arithmatex">\(s\mapsto \eta(s)=|s|^{m}\)</span> for an integer <span class="arithmatex">\(m\ge 1\)</span>.
If <span class="arithmatex">\(h\)</span> is <span class="arithmatex">\(C^{m-1}\)</span> near <span class="arithmatex">\(s=0\)</span>, then for every integer <span class="arithmatex">\(0\le k\le m-1\)</span>,</p>
<div class="arithmatex">\[
\frac{d^k}{ds^k}\bigl[\eta(s)\,h(s)\bigr]\Big|_{s=0}=0.
\]</div>
<p><em>Proof.</em> By Leibniz’ rule, every term in the <span class="arithmatex">\(k\)</span>-th derivative contains a factor <span class="arithmatex">\(|s|^{m-j}\)</span> with <span class="arithmatex">\(m-j\ge 1\)</span> when <span class="arithmatex">\(k\le m-1\)</span>,
and therefore vanishes at <span class="arithmatex">\(s=0\)</span>. <span class="arithmatex">\(\square\)</span></p>
<p><strong>Remark (regularity of the gate).</strong> For integer <span class="arithmatex">\(m\ge 1\)</span>, <span class="arithmatex">\(\eta(s)=|s|^m\)</span> is <span class="arithmatex">\(C^{m-1}\)</span> at <span class="arithmatex">\(s=0\)</span> (and smooth if <span class="arithmatex">\(m\)</span> is even),
which is exactly the regularity needed to conclude preservation of derivatives through order <span class="arithmatex">\(m-1\)</span>.</p>
<p><strong>Remark (mixed derivatives).</strong> In local coordinates <span class="arithmatex">\((s,y)\)</span> near the boundary (normal <span class="arithmatex">\(s\)</span> and tangential <span class="arithmatex">\(y\)</span>), any differential
operator involving at most <span class="arithmatex">\(m-1\)</span> derivatives in <span class="arithmatex">\(s\)</span> annihilates <span class="arithmatex">\(\eta(s)\,h(s,y)\)</span> at <span class="arithmatex">\(s=0\)</span>; tangential derivatives act on <span class="arithmatex">\(h\)</span>
and do not reduce the vanishing order in <span class="arithmatex">\(s\)</span>. The product structure of <span class="arithmatex">\(M(z)\)</span> yields the analogous preservation on boundary–initial
intersections for mixed normal/time derivatives up to the prescribed orders, assuming the corresponding derivatives exist.</p>
<p>Applying this lemma with <span class="arithmatex">\(m=K_\ell+1\)</span> for each boundary label <span class="arithmatex">\(\ell\)</span> and <span class="arithmatex">\(m=K_t+1\)</span> for time implies:</p>
<ul>
<li>the interior overlay does not change the value of <span class="arithmatex">\(u\)</span> on boundary/initial sets where <span class="arithmatex">\(M=0\)</span>,</li>
<li>it also does not change derivatives up to order <span class="arithmatex">\(K_\ell\)</span> (resp. <span class="arithmatex">\(K_t\)</span>) on those sets, provided the relevant derivatives exist.</li>
</ul>
<p>Consequently, if the boundary and initial stages have produced <span class="arithmatex">\(u\)</span> satisfying the enforced constraints up to those orders,
then <span class="arithmatex">\(\tilde u=u+\Delta u\)</span> satisfies them as well.</p>
<h3 id="a76-multiple-sources-envelopes-and-coincidence-handling">A.7.6. Multiple sources, envelopes, and coincidence handling<a class="headerlink" href="#a76-multiple-sources-envelopes-and-coincidence-handling" title="Permanent link">¤</a></h3>
<p>When multiple data sources are present, Phydrax optionally multiplies IDW weights by a source-local envelope
<span class="arithmatex">\(\psi_s(z)=\exp(-d_s(z)^2/s^2)\)</span>, where <span class="arithmatex">\(d_s(z)\)</span> is the distance to the nearest anchor from source <span class="arithmatex">\(s\)</span>.
This allows localized influence while preserving exactness at snapped anchors.</p>
<p>If anchors from different sources are coincident (according to the same snap metric used at runtime), they are deduplicated.
Conflicting coincident targets are rejected: exact enforcement of incompatible pointwise data is not possible.</p>
<h2 id="a8-multi-field-pipelines-co-variables-and-topological-ordering">A.8. Multi-field pipelines, co-variables, and topological ordering<a class="headerlink" href="#a8-multi-field-pipelines-co-variables-and-topological-ordering" title="Permanent link">¤</a></h2>
<p>For a vector of fields <span class="arithmatex">\((u^{(1)},\dots,u^{(M)})\)</span>, an enforced constraint for one field may require access to other fields
(co-variables). This defines a directed dependency graph on field names. If the graph is acyclic, there exists a
topological order <span class="arithmatex">\(u^{(i_1)},\dots,u^{(i_M)}\)</span> such that every co-variable needed for enforcing <span class="arithmatex">\(u^{(i_k)}\)</span> has been
enforced earlier in the order.</p>
<p>Applying per-field pipelines in this order yields a well-defined global enforcement map:</p>
<div class="arithmatex">\[
\mathcal P:\ (u^{(1)},\dots,u^{(M)})\mapsto (\tilde u^{(1)},\dots,\tilde u^{(M)}).
\]</div>
<p>If the dependency graph contains a cycle, a global deterministic enforcement map cannot be defined without additional
fixed-point structure; the implementation rejects such cycles.</p>
<h2 id="a9-compatibility-and-scope-conditions">A.9. Compatibility and scope conditions<a class="headerlink" href="#a9-compatibility-and-scope-conditions" title="Permanent link">¤</a></h2>
<p>For the strongest “exactness” statements, the following conditions are essential:</p>
<ol>
<li><strong>Compatibility on junctions and intersections.</strong> Piecewise boundary data must be compatible on junction sets
   <span class="arithmatex">\(J=\bigcup_{i\neq j}(\overline{\Gamma_i}\cap\overline{\Gamma_j})\)</span> if exact satisfaction is desired there, and boundary
   and initial data must be compatible on their intersection (e.g. <span class="arithmatex">\(\partial\Omega\times\lbrace t_0\rbrace\)</span>); otherwise,
   no construction can satisfy all requirements simultaneously. The staging priority enforces boundary constraints exactly
   and uses gates to avoid re-violating them.</li>
<li><strong>Nondegeneracy.</strong> Neumann/Robin constructions require <span class="arithmatex">\(\partial_n\phi\neq 0\)</span> on <span class="arithmatex">\(\partial\Omega\)</span>.</li>
<li><strong>Anchor placement.</strong> Interior anchors/tracks must lie strictly away from constrained sets so that <span class="arithmatex">\(M(z_i)&gt;0\)</span>.</li>
<li><strong>Regularity.</strong> To preserve derivative constraints through order <span class="arithmatex">\(K\)</span>, the gate factors and the field must admit
   the corresponding derivatives (at least <span class="arithmatex">\(C^K\)</span> in the relevant coordinates).</li>
<li><strong>Gating tradeoff.</strong> If the boundary gate <span class="arithmatex">\(\gamma\)</span> is not identically <span class="arithmatex">\(1\)</span> away from the boundary, then the gated blend
   cannot preserve boundary constraints and enforce initial constraints exactly everywhere simultaneously; instead, initial
   constraints are typically satisfied approximately away from the boundary.</li>
<li><strong>Approximation layers.</strong> BVH selection, MLS distance proxies, and approximate distance fields introduce numerical
   approximation. The mathematical statements above should be interpreted either in the idealized continuous limit or as
   “up to numerical tolerance” for practical computations.</li>
</ol>
<h2 id="a10-correspondence-to-the-implementation-terminology">A.10. Correspondence to the implementation (terminology)<a class="headerlink" href="#a10-correspondence-to-the-implementation-terminology" title="Permanent link">¤</a></h2>
<p>The following implementation concepts align with the mathematics above:</p>
<ul>
<li><strong>Boundary stage</strong>: piecewise constraints combined via weighted blending <span class="arithmatex">\(u_B\)</span>.</li>
<li><strong>Initial stage</strong>: higher-order <code>enforce_initial</code> overlay and/or other initial enforced constraints, blended via a boundary gate <span class="arithmatex">\(\gamma\)</span>.</li>
<li><strong>Interior stage</strong>: anchor/data correction <span class="arithmatex">\(u\mapsto u + M\cdot(\text{IDW interpolant of scaled residuals})\)</span> (with snapping for exact anchors).</li>
<li><strong>BVH</strong>: packed AABB tree used to accelerate boundary-subset weight evaluation for blending.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "toc.integrate", "header.autohide", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../_static/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>