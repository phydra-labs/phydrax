
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Phydrax scientific ML and PDE toolkit.">
      
      
        <meta name="author" content="Phydra Labs">
      
      
        <link rel="canonical" href="https://phydra-labs.github.io/phydrax/guides_differential/">
      
      
        <link rel="prev" href="../guides_domain/">
      
      
        <link rel="next" href="../guides_integrals/">
      
      
      <link rel="icon" href="../_static/phydra.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Differential operators - Phydrax</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../_static/custom_css.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#differential-operators" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Phydrax" class="md-header__button md-logo" aria-label="Phydrax" data-md-component="logo">
      
  <img src="../_static/phydra.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phydrax
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Differential operators
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/phydra-labs/phydrax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    phydra-labs/phydrax
  </div>
</a>

  <a href="https://x.com/PhydraLabs" title="@PhydraLabs" class="md-source md-source--x" aria-label="@PhydraLabs" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"/>
</svg>
    </div>
    
      <div class="md-source__repository md-source__repository--x">
        @PhydraLabs
      </div>
    
  </a>


  <a href="https://www.linkedin.com/company/phydra-labs" title="LinkedIn" class="md-source md-source--linkedin" aria-label="LinkedIn" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg viewBox="10 10 52 52" xmlns="http://www.w3.org/2000/svg">
  <path d="M62 62H51.315625V43.8021149C51.315625 38.8127542 49.4197917 36.0245323 45.4707031 36.0245323C41.1746094 36.0245323 38.9300781 38.9261103 38.9300781 43.8021149V62H28.6333333V27.3333333H38.9300781V32.0029283C38.9300781 32.0029283 42.0260417 26.2742151 49.3825521 26.2742151C56.7356771 26.2742151 62 30.7644705 62 40.051212V62ZM16.349349 22.7940133C12.8420573 22.7940133 10 19.9296567 10 16.3970067C10 12.8643566 12.8420573 10 16.349349 10C19.8566406 10 22.6970052 12.8643566 22.6970052 16.3970067C22.6970052 19.9296567 19.8566406 22.7940133 16.349349 22.7940133ZM11.0325521 62H21.769401V27.3333333H11.0325521V62Z" fill="currentColor"/>
</svg>
    </div>
  </a>

      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Phydrax" class="md-nav__button md-logo" aria-label="Phydrax" data-md-component="logo">
      
  <img src="../_static/phydra.png" alt="logo">

    </a>
    Phydrax
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/phydra-labs/phydrax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    phydra-labs/phydrax
  </div>
</a>

  <a href="https://x.com/PhydraLabs" title="@PhydraLabs" class="md-source md-source--x" aria-label="@PhydraLabs" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"/>
</svg>
    </div>
    
      <div class="md-source__repository md-source__repository--x">
        @PhydraLabs
      </div>
    
  </a>


  <a href="https://www.linkedin.com/company/phydra-labs" title="LinkedIn" class="md-source md-source--linkedin" aria-label="LinkedIn" target="_blank" rel="noopener">
    <div class="md-source__icon md-icon">
      <svg viewBox="10 10 52 52" xmlns="http://www.w3.org/2000/svg">
  <path d="M62 62H51.315625V43.8021149C51.315625 38.8127542 49.4197917 36.0245323 45.4707031 36.0245323C41.1746094 36.0245323 38.9300781 38.9261103 38.9300781 43.8021149V62H28.6333333V27.3333333H38.9300781V32.0029283C38.9300781 32.0029283 42.0260417 26.2742151 49.3825521 26.2742151C56.7356771 26.2742151 62 30.7644705 62 40.051212V62ZM16.349349 22.7940133C12.8420573 22.7940133 10 19.9296567 10 16.3970067C10 12.8643566 12.8420573 10 16.349349 10C19.8566406 10 22.6970052 12.8643566 22.6970052 16.3970067C22.6970052 19.9296567 19.8566406 22.7940133 16.349349 22.7940133ZM11.0325521 62H21.769401V27.3333333H11.0325521V62Z" fill="currentColor"/>
</svg>
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../all-of-phydrax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All of Phydrax
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cookbook
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cookbook
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook/poisson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Poisson (field learning)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook/heat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Heat equation (space–time)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook/inverse_and_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inverse + hybrid physics–data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook/operator_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operator learning (DatasetDomain)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides_domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domains and sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Differential operators
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Differential operators
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#notation-and-conventions" class="md-nav__link">
    <span class="md-ellipsis">
      Notation and conventions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gradient-jacobian" class="md-nav__link">
    <span class="md-ellipsis">
      Gradient / Jacobian
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gradient / Jacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geometry-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Geometry variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Scalar variables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hessian-laplacian-bi-laplacian" class="md-nav__link">
    <span class="md-ellipsis">
      Hessian, Laplacian, Bi-Laplacian
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hessian, Laplacian, Bi-Laplacian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hessian" class="md-nav__link">
    <span class="md-ellipsis">
      Hessian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#laplacian" class="md-nav__link">
    <span class="md-ellipsis">
      Laplacian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bi-laplacian" class="md-nav__link">
    <span class="md-ellipsis">
      Bi-Laplacian
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#divergence-and-curl" class="md-nav__link">
    <span class="md-ellipsis">
      Divergence and curl
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Divergence and curl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#divergence" class="md-nav__link">
    <span class="md-ellipsis">
      Divergence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curl-3d-only" class="md-nav__link">
    <span class="md-ellipsis">
      Curl (3D only)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backends-autodiff-finite-differences-spectralbasis" class="md-nav__link">
    <span class="md-ellipsis">
      Backends: autodiff, finite differences, spectral/basis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Backends: autodiff, finite differences, spectral/basis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jet-backend-taylor-mode-derivative-jets" class="md-nav__link">
    <span class="md-ellipsis">
      Jet backend (Taylor-mode / derivative jets)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coord-separable-sampling-and-grid-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Coord-separable sampling and grid evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#surface-differential-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Surface differential operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fractional-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Fractional operators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fractional operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fractional-laplacian-integral-estimator" class="md-nav__link">
    <span class="md-ellipsis">
      Fractional Laplacian (integral estimator)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grunwaldletnikov-monte-carlo-gmc" class="md-nav__link">
    <span class="md-ellipsis">
      Grünwald–Letnikov (Monte Carlo / GMC)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides_integrals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrals and measures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides_constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constraints and objectives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solvers and training
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/phydrax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Domains
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Domains
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/geometry1d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (1D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/geometry2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (2D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/geometry3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry (3D)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/composition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Composition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/domain/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/operators/differential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/operators/integral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/operators/functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/operators/linalg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear algebra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/operators/delay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delay
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Constraints
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/continuous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continuous
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/boundary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boundary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/discrete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discrete
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/enforced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforced constraint ansätze
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/cfd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CFD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/solid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/thermal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thermal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/constraints/em/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electromagnetics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Neural networks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Neural networks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/nn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/nn/layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/nn/architectures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architectures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/nn/structured/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structured
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/nn/wrappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wrappers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/nn/embeddings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/nn/activations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Activations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solver
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            Solver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/solver/functional_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional solver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/solver/enforced_constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforced constraint pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc/nondimensionalization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nondimensionalization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/differentiation_modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differentiation modes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/physics_constrained_interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Physics-Constrained Interpolation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/surely_youre_joking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Surely You're Joking!
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="differential-operators">Differential operators<a class="headerlink" href="#differential-operators" title="Permanent link">¤</a></h1>
<p>This page documents Phydrax's core differential operators from a mathematical point of view
and explains how they interact with <strong>labeled product domains</strong> and <strong>structured sampling</strong>.</p>
<h2 id="notation-and-conventions">Notation and conventions<a class="headerlink" href="#notation-and-conventions" title="Permanent link">¤</a></h2>
<p>Let the domain be a labeled product <span class="arithmatex">\(\Omega = \Omega_x \times \Omega_t \times \cdots\)</span>.
Phydrax represents functions as <code>DomainFunction</code> objects, which conceptually define a map</p>
<div class="arithmatex">\[
u:\Omega\to\mathbb{R}^{m_1\times\cdots\times m_k}.
\]</div>
<p>For a <em>geometry</em> label (typically <code>"x"</code>) with spatial dimension <span class="arithmatex">\(d\)</span>, write
<span class="arithmatex">\(x=(x_1,\dots,x_d)\in\mathbb{R}^d\)</span>. For a <em>scalar</em> label (typically <code>"t"</code>), write
<span class="arithmatex">\(t\in\mathbb{R}\)</span>.</p>
<p>Phydrax adopts the convention that <strong>derivative dimensions are appended on the right</strong>:</p>
<ul>
<li>if <span class="arithmatex">\(u\)</span> is scalar-valued, then <span class="arithmatex">\(\nabla_x u\)</span> has a trailing axis of length <span class="arithmatex">\(d\)</span>;</li>
<li>if <span class="arithmatex">\(u\)</span> is vector-valued with trailing size <span class="arithmatex">\(m\)</span>, then <span class="arithmatex">\(\nabla_x u\)</span> has trailing shape <span class="arithmatex">\((m,d)\)</span>;</li>
<li>higher-rank tensor values are differentiated componentwise, appending derivative axes.</li>
</ul>
<h2 id="gradient-jacobian">Gradient / Jacobian<a class="headerlink" href="#gradient-jacobian" title="Permanent link">¤</a></h2>
<p><code>phydrax.operators.grad(u, var="x")</code> constructs the gradient/Jacobian with respect to a labeled variable.</p>
<h3 id="geometry-variables">Geometry variables<a class="headerlink" href="#geometry-variables" title="Permanent link">¤</a></h3>
<p>For a geometry variable <span class="arithmatex">\(x\in\mathbb{R}^d\)</span>:</p>
<p>If <span class="arithmatex">\(u:\Omega\to\mathbb{R}\)</span> is scalar-valued, then</p>
<div class="arithmatex">\[
\nabla_x u = \left(\frac{\partial u}{\partial x_1},\dots,\frac{\partial u}{\partial x_d}\right).
\]</div>
<p>If <span class="arithmatex">\(u:\Omega\to\mathbb{R}^m\)</span> is vector-valued, then <code>grad</code> returns the Jacobian
<span class="arithmatex">\(J\in\mathbb{R}^{m\times d}\)</span> with entries <span class="arithmatex">\(J_{ij}=\partial u_i/\partial x_j\)</span>.</p>
<h3 id="scalar-variables">Scalar variables<a class="headerlink" href="#scalar-variables" title="Permanent link">¤</a></h3>
<p>For a scalar label <span class="arithmatex">\(t\)</span>, <code>grad(u, var="t")</code> reduces to the partial derivative <span class="arithmatex">\(\partial u/\partial t\)</span>.</p>
<h2 id="hessian-laplacian-bi-laplacian">Hessian, Laplacian, Bi-Laplacian<a class="headerlink" href="#hessian-laplacian-bi-laplacian" title="Permanent link">¤</a></h2>
<h3 id="hessian">Hessian<a class="headerlink" href="#hessian" title="Permanent link">¤</a></h3>
<p><code>phydrax.operators.hessian(u, var="x")</code> returns the matrix of second derivatives.
For scalar-valued <span class="arithmatex">\(u\)</span>,</p>
<div class="arithmatex">\[
H_{ij}(x)=\frac{\partial^2 u}{\partial x_i\,\partial x_j}.
\]</div>
<p>For vector-valued <span class="arithmatex">\(u\)</span>, the Hessian is taken componentwise, producing a trailing shape <span class="arithmatex">\((m,d,d)\)</span>.</p>
<h3 id="laplacian">Laplacian<a class="headerlink" href="#laplacian" title="Permanent link">¤</a></h3>
<p><code>phydrax.operators.laplacian(u, var="x")</code> computes</p>
<div class="arithmatex">\[
\Delta u \;=\; \nabla\cdot\nabla u \;=\; \sum_{i=1}^{d}\frac{\partial^2 u}{\partial x_i^2}
        \;=\; \text{tr}(\nabla^2 u).
\]</div>
<h3 id="bi-laplacian">Bi-Laplacian<a class="headerlink" href="#bi-laplacian" title="Permanent link">¤</a></h3>
<p><code>phydrax.operators.bilaplacian(u, var="x")</code> computes the fourth-order operator</p>
<div class="arithmatex">\[
\Delta^2 u \;=\; \Delta(\Delta u).
\]</div>
<h2 id="divergence-and-curl">Divergence and curl<a class="headerlink" href="#divergence-and-curl" title="Permanent link">¤</a></h2>
<h3 id="divergence">Divergence<a class="headerlink" href="#divergence" title="Permanent link">¤</a></h3>
<p>For a vector field <span class="arithmatex">\(v:\Omega\to\mathbb{R}^d\)</span>, <code>phydrax.operators.div(v, var="x")</code> computes</p>
<div class="arithmatex">\[
\nabla\cdot v = \sum_{i=1}^{d}\frac{\partial v_i}{\partial x_i} = \text{tr}(\nabla v).
\]</div>
<p>If <span class="arithmatex">\(v\)</span> has additional leading value axes (e.g. multiple vector fields stacked), divergence is applied
componentwise over those leading value axes.</p>
<h3 id="curl-3d-only">Curl (3D only)<a class="headerlink" href="#curl-3d-only" title="Permanent link">¤</a></h3>
<p>For <span class="arithmatex">\(v:\Omega\to\mathbb{R}^3\)</span>, <code>phydrax.operators.curl(v, var="x")</code> computes</p>
<div class="arithmatex">\[
\nabla\times v =
\begin{pmatrix}
  \partial_y v_z - \partial_z v_y \\
  \partial_z v_x - \partial_x v_z \\
  \partial_x v_y - \partial_y v_x
\end{pmatrix}.
\]</div>
<h2 id="backends-autodiff-finite-differences-spectralbasis">Backends: autodiff, finite differences, spectral/basis<a class="headerlink" href="#backends-autodiff-finite-differences-spectralbasis" title="Permanent link">¤</a></h2>
<p>Many differential operators accept a <code>backend</code> keyword:</p>
<ul>
<li><code>backend="ad"</code> uses autodiff and works for both point sampling and coord-separable sampling.</li>
<li><code>backend="jet"</code> uses Taylor-mode AD ("jets") for higher-order derivatives with respect to a single variable.</li>
<li><code>backend="fd"</code> uses finite differences on coord-separable grids (and falls back to autodiff for point inputs).</li>
<li><code>backend="basis"</code> uses basis-aware methods on coord-separable grids (and falls back to autodiff for point inputs).</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code>LatentContractionModel</code> wrapped via <code>domain.Model(...)</code>, <code>partial</code>,
<code>partial_n</code>, <code>dt_n</code>, and <code>laplacian</code> may take an exact latent-factor derivative
contraction route under <code>backend="jet"</code>. For <code>backend="ad"</code>, Phydrax stays on
AD derivatives (or directional JVP if <code>ad_engine="jvp"</code> is explicitly selected).
The latent contraction route is an acceleration path (not an approximation): if
preconditions are not met, Phydrax falls back to the generic derivative path and
applies the model's configured fallback policy (<code>warn</code>, <code>error</code>, or <code>silent</code>).</p>
</div>
<h3 id="jet-backend-taylor-mode-derivative-jets">Jet backend (Taylor-mode / derivative jets)<a class="headerlink" href="#jet-backend-taylor-mode-derivative-jets" title="Permanent link">¤</a></h3>
<p>The jet backend propagates a <em>truncated derivative jet</em> through the computation graph. Concretely, for a smooth
map <span class="arithmatex">\(f\)</span> and a direction <span class="arithmatex">\(v\)</span>, it computes the derivatives of the 1D curve <span class="arithmatex">\(y(\epsilon)=f(x+\epsilon v)\)</span> at
<span class="arithmatex">\(\epsilon=0\)</span>, i.e. the coefficients of the Taylor expansion</p>
<div class="arithmatex">\[
f(x+\epsilon v)
= \sum_{k=0}^{K}\frac{\epsilon^k}{k!}\,D^k f(x)[v,\dots,v] + O(\epsilon^{K+1}).
\]</div>
<p>Under the hood, higher-order chain rules are governed by the Faà di Bruno formula. In one dimension, for a
composition <span class="arithmatex">\(f\circ g\)</span>,</p>
<div class="arithmatex">\[
(f\circ g)^{(n)}(x)
= \sum_{k=1}^{n} f^{(k)}(g(x))\,B_{n,k}\bigl(g'(x),g''(x),\dots,g^{(n-k+1)}(x)\bigr),
\]</div>
<p>where <span class="arithmatex">\(B_{n,k}\)</span> are the (partial) Bell polynomials. Jet-mode AD implements these combinatorics automatically,
which is why it can be more direct than nesting <code>jax.jacfwd</code>/<code>jax.jacrev</code> when you need <span class="arithmatex">\(n\ge 2\)</span> derivatives
with respect to the <em>same</em> variable.</p>
<p>The <code>basis</code> keyword (used when <code>backend="basis"</code>) selects a 1D method along each coord-separable axis:</p>
<ul>
<li><code>basis="fourier"</code>: FFT-based spectral derivatives on periodic grids;</li>
<li><code>basis="sine"</code> / <code>basis="cosine"</code>: FFT-based derivatives via odd/even extension;</li>
<li><code>basis="poly"</code>: polynomial (barycentric) differentiation on generic 1D grids.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FFT-based bases (<code>fourier</code>/<code>sine</code>/<code>cosine</code>) assume a uniformly-spaced coordinate axis.</p>
</div>
<h2 id="coord-separable-sampling-and-grid-evaluation">Coord-separable sampling and grid evaluation<a class="headerlink" href="#coord-separable-sampling-and-grid-evaluation" title="Permanent link">¤</a></h2>
<p>When you sample a <code>CoordSeparableBatch</code>, selected labels provide a <strong>tuple of 1D coordinate axes</strong>
instead of a point cloud. For a 2D geometry label <code>"x"</code>, the model/operator receives
<span class="arithmatex">\((x_{\text{axis}}, y_{\text{axis}})\)</span>; for a scalar label (e.g. <code>"t"</code>), the tuple has one axis.</p>
<p>This is the preferred mode for spectral operators and neural operators (FNO/DeepONet).</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Laplacian on a periodic 1D grid using the basis backend:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax.random</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">phydrax</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">phx</span>

<span class="n">geom</span> <span class="o">=</span> <span class="n">phx</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">Interval1d</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="nd">@geom</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">u</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">lap_u</span> <span class="o">=</span> <span class="n">phx</span><span class="o">.</span><span class="n">operators</span><span class="o">.</span><span class="n">laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;basis&quot;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;fourier&quot;</span><span class="p">)</span>

<span class="n">batch</span> <span class="o">=</span> <span class="n">geom</span><span class="o">.</span><span class="n">component</span><span class="p">()</span><span class="o">.</span><span class="n">sample_coord_separable</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">phx</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">FourierAxisSpec</span><span class="p">(</span><span class="mi">64</span><span class="p">)},</span> <span class="n">key</span><span class="o">=</span><span class="n">jr</span><span class="o">.</span><span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">lap_u</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</code></pre></div>
</div>
<h2 id="surface-differential-operators">Surface differential operators<a class="headerlink" href="#surface-differential-operators" title="Permanent link">¤</a></h2>
<p>Several operators act on fields restricted to a geometry boundary (surface/curve). These use the
outward unit normal <span class="arithmatex">\(n\)</span> provided by the geometry and project ambient derivatives onto the tangent
space.</p>
<p>Let <span class="arithmatex">\(\Gamma = \partial\Omega_x\)</span> be a smooth boundary in <span class="arithmatex">\(\mathbb{R}^d\)</span> with unit normal
<span class="arithmatex">\(n(x)\in\mathbb{R}^d\)</span>. Define the tangential projector</p>
<div class="arithmatex">\[
P(x) = I - n(x)\,n(x)^\top.
\]</div>
<p>For a scalar field <span class="arithmatex">\(u\)</span>, the <strong>surface gradient</strong> is</p>
<div class="arithmatex">\[
\nabla_\Gamma u = P\,\nabla u.
\]</div>
<p>For a (tangent) vector field <span class="arithmatex">\(v\)</span>, the <strong>surface divergence</strong> is</p>
<div class="arithmatex">\[
\nabla_\Gamma\cdot v = \text{tr}\!\left(P\,\nabla v\right).
\]</div>
<p>The <strong>Laplace–Beltrami</strong> operator is the surface analogue of the Laplacian:</p>
<div class="arithmatex">\[
\Delta_\Gamma u = \nabla_\Gamma\cdot(\nabla_\Gamma u).
\]</div>
<p>In Phydrax, these operators are exposed as <code>surface_grad</code>, <code>surface_div</code>, and
<code>laplace_beltrami</code> (see <a href="../api/operators/differential/">API → Operators → Differential</a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Surface operators are intended to be evaluated on boundary components so that the geometry
can supply consistent normals.</p>
</div>
<h2 id="fractional-operators">Fractional operators<a class="headerlink" href="#fractional-operators" title="Permanent link">¤</a></h2>
<p>Phydrax includes a small set of fractional derivative operators, primarily for experimentation.</p>
<h3 id="fractional-laplacian-integral-estimator">Fractional Laplacian (integral estimator)<a class="headerlink" href="#fractional-laplacian-integral-estimator" title="Permanent link">¤</a></h3>
<p>For <span class="arithmatex">\(0&lt;\alpha&lt;2\)</span>, the fractional Laplacian in <span class="arithmatex">\(\mathbb{R}^d\)</span> can be written (up to a constant
<span class="arithmatex">\(C_{d,\alpha}\)</span>) as a singular integral:</p>
<div class="arithmatex">\[
(-\Delta)^{\alpha/2}u(x)
\propto \int_{\mathbb{R}^d}\frac{u(x)-u(y)}{\|x-y\|^{d+\alpha}}\,dy.
\]</div>
<p><code>phydrax.operators.fractional_laplacian</code> implements a <strong>truncated</strong> ball estimator using offsets
<span class="arithmatex">\(y=x+\xi\)</span> with <span class="arithmatex">\(\|\xi\|\le R\)</span>:</p>
<div class="arithmatex">\[
\int_{B_R(0)} \frac{u(x)-u(x+\xi)}{\|\xi\|^{d+\alpha}}\,d\xi.
\]</div>
<p>The implementation excludes a small neighborhood <span class="arithmatex">\(\|\xi\|\le\varepsilon\)</span> to avoid the
singularity, and can optionally reduce variance for <span class="arithmatex">\(\alpha&gt;1\)</span> by subtracting a first-order
correction involving <span class="arithmatex">\(\nabla u\)</span> (<code>desingularize=True</code>).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The returned value is <em>not</em> normalized by <span class="arithmatex">\(C_{d,\alpha}\)</span>, and the truncation radius <span class="arithmatex">\(R\)</span>
introduces a modeling choice. Use this operator with care and validate against known
solutions.</p>
</div>
<h3 id="grunwaldletnikov-monte-carlo-gmc">Grünwald–Letnikov (Monte Carlo / GMC)<a class="headerlink" href="#grunwaldletnikov-monte-carlo-gmc" title="Permanent link">¤</a></h3>
<p>For one-sided fractional derivatives (currently <span class="arithmatex">\(\alpha\in(1,2)\)</span>), Phydrax provides a Monte Carlo
variant of a Grünwald–Letnikov discretization; see <code>fractional_derivative_gl_mc</code> and related
helpers on the API page.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "toc.integrate", "header.autohide", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../_static/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>